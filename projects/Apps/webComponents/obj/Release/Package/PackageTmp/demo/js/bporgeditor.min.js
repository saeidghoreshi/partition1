/*
 Basic Primitives orgEditor Demo v1.0.29

 (c) Adeltech Productions Inc


 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license

*/
(function(){var a=["primitives","orgeditor"],b=window,c;for(c=0;c<a.length;c+=1)b=b[a[c]]=b[a[c]]||{}})();primitives.orgeditor.updateTips=function(a,b){a.text(b).addClass("ui-state-highlight")};primitives.orgeditor.checkLength=function(a,b,c,d,e){var f=!0;if(b.val().length>e||b.val().length<d)b.addClass("ui-state-error"),primitives.orgeditor.updateTips(a,"Length of "+c+" must be between "+d+" and "+e+"."),f=!1;return f};
primitives.orgeditor.checkColor=function(a,b,c){var d=primitives.common.getColorHexValue(b.val()),e=/^#[0-9a-f]{3}([0-9a-f]{3})?$/i;null==d||!e.test(d)?(b.addClass("ui-state-error"),primitives.orgeditor.updateTips(a,c+" has wrong color value: "+d),a=!1):(b.val(d),a=!0);return a};primitives.orgeditor.TemplateName={Default:"",Contact:"contactTemplate",PlainDescription:"plainDescriptionTemplate",Invisible:"invisibleTemplate"};primitives.orgeditor.UserTemplate=function(){this.name=""};
primitives.orgeditor.UserTemplate.prototype.getTemplate=function(){return""};primitives.orgeditor.UserTemplate.prototype.onRender=function(){};primitives.orgeditor.UserTemplateContact=function(){this.name="contactTemplate"};primitives.orgeditor.UserTemplateContact.prototype=new primitives.orgeditor.UserTemplate;
primitives.orgeditor.UserTemplateContact.prototype.getTemplate=function(){var a=new primitives.orgdiagram.TemplateConfig,b;a.name=this.name;a.itemSize=new primitives.common.Size(180,120);a.minimizedItemSize=new primitives.common.Size(4,4);a.highlightPadding=new primitives.common.Thickness(2,2,2,2);b=jQuery('<div class="bp-item bp-corner-all bt-item-frame"><div name="titleBackground" class="bp-item bp-corner-all bp-title-frame" style="top: 2px; left: 2px; width: 176px; height: 20px;"><div name="title" class="bp-item bp-title" style="top: 3px; left: 6px; width: 168px; height: 18px;"></div></div><div class="bp-item bp-photo-frame" style="top: 26px; left: 2px; width: 50px; height: 60px;"><img name="photo" style="height=60px; width=50px;" /></div><div name="phone" class="bp-item" style="top: 26px; left: 56px; width: 122px; height: 18px; font-size: 12px;"></div><div name="email" class="bp-item" style="top: 44px; left: 56px; width: 122px; height: 18px; font-size: 12px;"></div><div name="description" class="bp-item" style="top: 62px; left: 56px; width: 122px; height: 36px; font-size: 10px;"></div><a name="readmorelabel" class="bp-item bp-readmore" style="top: 102px; left: 4px; width: 172px; height: 16px; font-size: 10px;"></a></div>').css({width:a.itemSize.width+
"px",height:a.itemSize.height+"px"});a.itemTemplate=b.wrap("<div>").parent().html();return a};
primitives.orgeditor.UserTemplateContact.prototype.onRender=function(a,b,c){var a=b.context,d,e,f,g,h;h=b.element.find("[name=readmorelabel]");switch(b.renderingMode){case primitives.common.RenderingMode.Create:h.click(function(a){primitives.common.stopPropagation(a)})}b.element.find("[name=photo]").attr({src:a.image});b.element.find("[name=titleBackground]").css({background:a.itemTitleColor});b.element.find("[name=title]").css({color:primitives.common.highestContrast(a.itemTitleColor,c.itemTitleSecondFontColor,
c.itemTitleFirstFontColor)});e=["title","description","phone","email","readmorelabel"];c=0;for(d=e.length;c<d;c+=1)f=e[c],g=b.element.find("[name="+f+"]"),f=null!=a[f]?a[f]:"",g.text()!==f&&g.text(f);h.css({visibility:!primitives.common.isNullOrEmpty(a.readmorelabel)?"inherit":"hidden"});primitives.common.isNullOrEmpty(a.readmoreurl)?h.removeAttr("href"):h.attr({href:a.readmoreurl})};primitives.orgeditor.UserTemplateDescription=function(){this.name="plainDescriptionTemplate"};
primitives.orgeditor.UserTemplateDescription.prototype=new primitives.orgeditor.UserTemplate;
primitives.orgeditor.UserTemplateDescription.prototype.getTemplate=function(){var a=new primitives.orgdiagram.TemplateConfig,b;a.name=this.name;a.itemSize=new primitives.common.Size(120,100);a.minimizedItemSize=new primitives.common.Size(4,4);a.highlightPadding=new primitives.common.Thickness(2,2,2,2);b=jQuery('<div class="bp-item bp-corner-all bt-item-frame"><div name="titleBackground" class="bp-item bp-corner-all bp-title-frame" style="top: 2px; left: 2px; width: 116px; height: 20px;"><div name="title" class="bp-item bp-title" style="top: 3px; left: 6px; width: 108px; height: 18px;"></div></div><div name="description" class="bp-item" style="top: 26px; left: 4px; width: 112px; height: 56px; font-size: 10px;"></div><a name="readmorelabel" class="bp-item bp-readmore" style="top: 82px; left: 4px; width: 112px; height: 16px; font-size: 10px;"></a></div>').css({width:a.itemSize.width+"px",
height:a.itemSize.height+"px"});a.itemTemplate=b.wrap("<div>").parent().html();return a};
primitives.orgeditor.UserTemplateDescription.prototype.onRender=function(a,b,c){var a=b.context,d,e,f,g,h;h=b.element.find("[name=readmorelabel]");switch(b.renderingMode){case primitives.common.RenderingMode.Create:h.click(function(a){primitives.common.stopPropagation(a)})}b.element.find("[name=titleBackground]").css({background:a.itemTitleColor});b.element.find("[name=title]").css({color:primitives.common.highestContrast(a.itemTitleColor,c.itemTitleSecondFontColor,c.itemTitleFirstFontColor)});e=
["title","description","readmorelabel"];c=0;for(d=e.length;c<d;c+=1)f=e[c],g=b.element.find("[name="+f+"]"),f=null!=a[f]?a[f]:"",g.text()!==f&&g.text(f);h.css({visibility:!primitives.common.isNullOrEmpty(a.readmorelabel)?"inherit":"hidden"});primitives.common.isNullOrEmpty(a.readmoreurl)?h.removeAttr("href"):h.attr({href:a.readmoreurl})};primitives.orgeditor.UserTemplateInvisible=function(){this.name="invisibleTemplate"};primitives.orgeditor.UserTemplateInvisible.prototype=new primitives.orgeditor.UserTemplate;
primitives.orgeditor.UserTemplateInvisible.prototype.getTemplate=function(){var a=new primitives.orgdiagram.TemplateConfig,b;a.name=this.name;a.itemSize=new primitives.common.Size(120,100);a.minimizedItemSize=new primitives.common.Size(4,4);a.highlightPadding=new primitives.common.Thickness(2,2,2,2);b=jQuery('<div class="bp-item bp-corner-all bt-item-frame"><div class="bp-item" style="top: 4px; left: 4px; width: 112px; height: 92px; font-size: 10px;">This item is invisible to user and its children logically belong to its first visible parent.</div></div>').css({width:a.itemSize.width+
"px",height:a.itemSize.height+"px"});a.itemTemplate=b.wrap("<div>").parent().html();return a};primitives.orgeditor.UserTemplateInvisible.prototype.onRender=function(a,b){var c=b.context;b.element.find("[name=title]").text(c.title)};
primitives.orgeditor.Config=function(){this.classPrefix="bporgeditor";this.onSave=null;this.editMode=!0;this.pageFitMode=primitives.orgdiagram.PageFitMode.FitToPage;this.verticalAlignment=primitives.common.VerticalAlignmentType.Middle;this.horizontalAlignment=primitives.common.HorizontalAlignmentType.Center;this.connectorType=primitives.orgdiagram.ConnectorType.Angular;this.rootItem=null;this.selectionPathMode=primitives.orgdiagram.SelectionPathMode.FullStack;this.minimalVisibility=primitives.orgdiagram.Visibility.Dot;
this.defaultTemplateName=null;this.itemTitleFirstFontColor=primitives.common.Colors.White;this.itemTitleSecondFontColor=primitives.common.Colors.Navy;this.childrenPlacementType=primitives.orgdiagram.ChildrenPlacementType.Horizontal;this.leavesPlacementType=primitives.orgdiagram.ChildrenPlacementType.Matrix;this.normalLevelShift=20;this.lineLevelShift=this.dotLevelShift=10;this.normalItemsInterval=20;this.dotItemsInterval=10;this.lineItemsInterval=5};
primitives.orgeditor.Controller=function(){this.widgetEventPrefix="bporgeditor";this.options=new primitives.orgeditor.Config;this.selectedItem=this.dlgMessage=this.dlgCodeMirror=this.dlgConfig=this.dlgItemConfig=this.dlgOrgChart=this.orgDiagram=this.formsPlaceholder=null;this.fieldsToClone="pageFitMode orientationType verticalAlignment horizontalAlignment connectorType minimalVisibility selectionPathMode leavesPlacementType childrenPlacementType normalLevelShift dotLevelShift lineLevelShift normalItemsInterval dotItemsInterval lineItemsInterval itemTitleFirstFontColor itemTitleSecondFontColor defaultTemplateName rootItem".split(" ");
this.userTemplates={contactTemplate:new primitives.orgeditor.UserTemplateContact,plainDescriptionTemplate:new primitives.orgeditor.UserTemplateDescription,invisibleTemplate:new primitives.orgeditor.UserTemplateInvisible}};primitives.orgeditor.Controller.prototype._create=function(){this.element.addClass("bp-item");this._createLayout()};primitives.orgeditor.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.orgeditor.Controller.prototype._createLayout=function(){new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());var a;a="";this.options.editMode&&(a+='\t<div name="forms-placeholder" class="bp-item" style="overflow:hidden; display:none;">\t\t<div name="dialog-confirm" class="dialog-form" title="Delete?">\t\t\t<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>This item and all its sub-items will be deleted. Are you sure?</p>\t\t</div>\t\t<div name="dialog-message" title="Warning">\t\t\t<p><span class="ui-icon ui-icon-circle-check" style="float: left; margin: 0 7px 50px 0;"></span>\t\t\t\tYou cannot remove or move root item in organizational chart.\t\t\t</p>\t\t</div>\t\t<div name="config-form"></div>\t\t<div name="codemirror-form" style="margin:0; padding:0;"></div>\t\t<div name="itemconfig-form"></div>\t\t<div name="orgchart-form"></div> </div>');
a+='\t<div name="orgchart-widget" class="bp-item" style="overflow:hidden; padding: 0px; margin: 0px; border: 0px;"></div>';this.options.editMode&&(a+='<div  style="padding: 0px; margin:10px;"><div style="width:120px;" name="options-button">Options</div><div style="width:120px;" name="json-button">JSON</div></div>');a=jQuery(a).addClass(this.widgetEventPrefix);this.element.append(a);this._createWidgets(this.element)};
primitives.orgeditor.Controller.prototype._createWidgets=function(){var a=(new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight())).getCSS(),b=this;this.formsPlaceholder=this.element.find("[name=forms-placeholder]");this.formsPlaceholder.css(a);this.dlgOrgChart=this.element.find("[name=orgchart-form]").bpDlgOrgDiagram();this.dlgConfig=this.element.find("[name=config-form]").bpDlgConfig();null!=window.CodeMirror&&(this.dlgCodeMirror=this.element.find("[name=codemirror-form]").bpDlgCodeMirror());
this.dlgItemConfig=this.element.find("[name=itemconfig-form]").bpDlgItemConfig();this.dlgMessage=this.element.find("[name=dialog-message]");this.dlgConfirm=this.element.find("[name=dialog-confirm]");this.orgDiagram=this.element.find("[name=orgchart-widget]");this.orgDiagram.css(a);this.orgDiagram.orgDiagram();this.orgDiagram.orgDiagram("option",this._getOrgDiagramConfig());this.orgDiagram.orgDiagram("update");this.element.find("[name=options-button]").button().click(function(){b._onOptionsButtonClick()});
this.element.find("[name=json-button]").button().click(function(){b._onJsonButtonClick()})};primitives.orgeditor.Controller.prototype._onOptionsButtonClick=function(){var a=this,b,c,d,e;a.dlgConfig.bpDlgConfig("option",{cancel:function(){},update:function(){e={};b=0;for(c=a.fieldsToClone.length;b<c;b+=1)d=a.fieldsToClone[b],e[d]=a.options[d];a.orgDiagram.orgDiagram("option",e);a.orgDiagram.orgDiagram("update");a._trigger("onSave")}});a.dlgConfig.bpDlgConfig("open",a.options)};
primitives.orgeditor.Controller.prototype._onJsonButtonClick=function(){var a=this,b,c,d,e;if(null!=this.dlgCodeMirror){a.dlgCodeMirror.bpDlgCodeMirror("option",{cancel:function(){},update:function(f,g){e={};b=0;for(c=a.fieldsToClone.length;b<c;b+=1)d=a.fieldsToClone[b],a.options[d]=g[d],e[d]=g[d];a._updateItemConfigs(e.rootItem);e.cursorItem=e.rootItem;a.orgDiagram.orgDiagram("option",e);a.orgDiagram.orgDiagram("update");a._trigger("onSave")}});e={};b=0;for(c=a.fieldsToClone.length;b<c;b+=1)d=a.fieldsToClone[b],
e[d]=a.options[d];a.dlgCodeMirror.bpDlgCodeMirror("open",JSON.stringify(e,void 0,2))}else alert("In order to enable this function you have to download latest version of Basic Primitives Joomla modules.")};primitives.orgeditor.Controller.prototype._cleanLayout=function(){this.element.find("."+this.widgetEventPrefix).remove()};
primitives.orgeditor.Controller.prototype._updateItemConfigs=function(a){var b,c;a.isVisible=!0;"invisibleTemplate"===a.templateName&&(a.isVisible=this.options.editMode);b=0;for(c=a.items.length;b<c;b+=1)this._updateItemConfigs(a.items[b])};primitives.orgeditor.Controller.prototype._updateLayout=function(){var a=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.formsPlaceholder.css(a.getCSS());this.orgDiagram.css(a.getCSS())};
primitives.orgeditor.Controller.prototype.update=function(a){this._updateLayout();this.orgDiagram.orgDiagram("update",a)};
primitives.orgeditor.Controller.prototype._getOrgDiagramConfig=function(){var a=this,b=[],c,d,e,f;for(c in this.userTemplates)this.userTemplates.hasOwnProperty(c)&&b.push(this.userTemplates[c].getTemplate());f=new primitives.orgdiagram.Config;c=0;for(d=a.fieldsToClone.length;c<d;c+=1)e=a.fieldsToClone[c],f[e]=a.options[e];this._updateItemConfigs(a.options.rootItem);f.cursorItem=a.options.rootItem;f.hasButtons=primitives.common.Enabled.False;f.hasSelectorCheckbox=primitives.common.Enabled.False;f.templates=
b;f.onItemRender=function(b,c){a.userTemplates[c.templateName].onRender(b,c,a.options)};f.onMouseClick=function(b,c){a._onMouseClick(b,c)};this.options.editMode&&(f.hasButtons=primitives.common.Enabled.Auto,f.hasSelectorCheckbox=primitives.common.Enabled.True,f.buttons=[new primitives.orgdiagram.ButtonConfig("properties","ui-icon-person","Edit"),new primitives.orgdiagram.ButtonConfig("delete","ui-icon-trash","Delete"),new primitives.orgdiagram.ButtonConfig("add","ui-icon-plus","Add"),new primitives.orgdiagram.ButtonConfig("move",
"ui-icon-arrow-4","Move")],f.onButtonClick=function(b,c){a._onButtonClick(b,c)});return f};primitives.orgeditor.Controller.prototype._onMouseClick=function(a,b){if(!this.options.editMode){var c=this.orgDiagram.orgDiagram("option","cursorItem");c===b.context&&!primitives.common.isNullOrEmpty(c.readmoreurl)&&(window.location.href=c.readmoreurl)}};
primitives.orgeditor.Controller.prototype._onButtonClick=function(a,b){var c=this,d,e,f,g;switch(b.name){case "delete":null===b.parentItem?c.dlgMessage.dialog({modal:!0,buttons:{Ok:function(){jQuery(this).dialog("close")}}}):c.dlgConfirm.dialog({resizable:!1,height:240,modal:!0,buttons:{Delete:function(){var a=primitives.common.indexOf(b.parentItem.items,b.context);b.parentItem.items.splice(a,1);c.orgDiagram.orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh);jQuery(this).dialog("close");
c._trigger("onSave")},Cancel:function(){jQuery(this).dialog("close")}}});break;case "properties":c.dlgItemConfig.bpDlgItemConfig("option",{cancel:function(){},update:function(){c.orgDiagram.orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh);c.options.rootItem=c.orgDiagram.orgDiagram("option","rootItem");c._trigger("onSave")}});c.dlgItemConfig.bpDlgItemConfig("open",b.context);break;case "add":c.selectedItem=b.context;c.dlgItemConfig.bpDlgItemConfig("option",{cancel:function(){},update:function(a,
b){c.selectedItem.items.push(b);c.orgDiagram.orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh);c._trigger("onSave")}});c.dlgItemConfig.bpDlgItemConfig("open");break;case "move":if(null===b.parentItem)c.dlgMessage.dialog({modal:!0,buttons:{Ok:function(){jQuery(this).dialog("close")}}});else{c.selectedItem=b.context;c.dlgOrgChart.bpDlgOrgDiagram("option",{cancel:function(){},update:function(a,d){var e=primitives.common.indexOf(b.parentItem.items,b.context);0<=e&&b.parentItem.items.splice(e,
1);d.items.push(b.context);c.orgDiagram.orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh);c._trigger("onSave")}});d=new primitives.orgdiagram.Config;e=0;for(f=c.fieldsToClone.length;e<f;e+=1)g=c.fieldsToClone[e],d[g]=c.options[g];d.hasButtons=primitives.common.Enabled.False;d.hasSelectorCheckbox=primitives.common.Enabled.False;d.rootItem=c.options.rootItem;d.cursorItem=c.orgDiagram.orgDiagram("option","cursorItem");c.dlgOrgChart.bpDlgOrgDiagram("open",d,b.context)}}};
primitives.orgeditor.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments)};(function(a){a.widget("ui.bpOrgEditor",new primitives.orgeditor.Controller)})(jQuery);primitives.orgeditor.DlgCodeMirrorOptions=function(){this.update=this.cancel=null};primitives.orgeditor.DlgCodeMirror=function(){this.widgetEventPrefix="bpdlgjson";this.options=new primitives.orgeditor.DlgCodeMirrorOptions;this.editor=this.content=this.placeholder=null};
primitives.orgeditor.DlgCodeMirror.prototype._create=function(){this._createLayout()};primitives.orgeditor.DlgCodeMirror.prototype.destroy=function(){this._cleanLayout()};
primitives.orgeditor.DlgCodeMirror.prototype._createLayout=function(){new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());var a;this.placeholder=jQuery(a+'<div style="overflow: hidden; padding:0; margin:0; border: 0px;"><form><textarea name="content"></textarea></form></div>').addClass(this.widgetEventPrefix);this.element.append(this.placeholder);this.element.addClass("dialog-form");this.content=this.element.find("[name=content]")};
primitives.orgeditor.DlgCodeMirror.prototype._updateLayout=function(){var a=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight()),b=this.element.find(".CodeMirror");this.placeholder.css(a.getCSS());b.css(a.getCSS());this.editor.setSize(a.width+"px",a.height+"px")};primitives.orgeditor.DlgCodeMirror.prototype._cleanLayout=function(){this.element.empty();this.element.removeClass("dialog-form")};
primitives.orgeditor.DlgCodeMirror.prototype.open=function(a){var b=this;this.content.val(a);this.editor=CodeMirror.fromTextArea(this.content[0],{lineNumbers:!0,matchBrackets:!0});this.element.dialog({autoOpen:!1,minWidth:640,minHeight:480,modal:!0,title:"Organizational Chart Data",buttons:{Save:function(){a=JSON.parse(b.editor.getValue());jQuery(this).dialog("close");b._trigger("update",null,a)},Cancel:function(){jQuery(this).dialog("close");b._trigger("cancel",null)}},resizeStop:function(){b._updateLayout()},
close:function(){b.editor.toTextArea();b._trigger("cancel",null)},open:function(){b._updateLayout()}}).dialog("open")};primitives.orgeditor.DlgCodeMirror.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments)};(function(a){a.widget("ui.bpDlgCodeMirror",new primitives.orgeditor.DlgCodeMirror)})(jQuery);primitives.orgeditor.DlgConfigOptions=function(){this.update=this.cancel=null};
primitives.orgeditor.DlgConfig=function(){this.widgetEventPrefix="bpdlgconfig";this.options=new primitives.orgeditor.DlgConfigOptions;this.tips=this.itemTitleSecondFontColor=this.itemTitleFirstFontColor=this.defaultTemplateName=this.leavesPlacementType=this.childrenPlacementType=this.selectionPathMode=this.minimalVisibility=this.connectorType=this.horizontalAlignment=this.verticalAlignment=this.orientationType=this.pageFitMode=null;this.enums={pageFitMode:{name:primitives.orgdiagram.PageFitMode,title:"Page Fit Mode",
isString:!1},orientationType:{name:primitives.orgdiagram.OrientationType,title:"Orientation",isString:!1},verticalAlignment:{name:primitives.common.VerticalAlignmentType,title:"Items Vertical Alignment",isString:!1},horizontalAlignment:{name:primitives.common.HorizontalAlignmentType,title:"Items Horizontal Alignment",isString:!1},connectorType:{name:primitives.orgdiagram.ConnectorType,title:"Connectors",isString:!1},minimalVisibility:{name:primitives.orgdiagram.Visibility,title:"Minimal nodes visibility",
isString:!1},selectionPathMode:{name:primitives.orgdiagram.SelectionPathMode,title:"Selection Path Mode",isString:!1},childrenPlacementType:{name:primitives.orgdiagram.ChildrenPlacementType,title:"Children placement",isString:!1},leavesPlacementType:{name:primitives.orgdiagram.ChildrenPlacementType,title:"Leaves placement",isString:!1},defaultTemplateName:{name:primitives.orgeditor.TemplateName,title:"Default item template",isString:!0}}};primitives.orgeditor.DlgConfig.prototype._create=function(){this._createLayout()};
primitives.orgeditor.DlgConfig.prototype.destroy=function(){this._cleanLayout()};
primitives.orgeditor.DlgConfig.prototype._createLayout=function(){new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());var a,b,c;a='<p class="validateTips">All form fields are required.</p><form><fieldset>';for(b in this.enums)this.enums.hasOwnProperty(b)&&(c=this.enums[b],a+='<br/><label for="'+b+'">'+c.title+'</label><select class="text ui-widget-content ui-corner-all" style="padding:2px; margin:5px;" name="'+b+'"></select>');a=jQuery(a+'<br/><label for="itemTitleFirstFontColor">Title first font color</label><input type="text" name="itemTitleFirstFontColor" class="text ui-widget-content ui-corner-all" /><br/><label for="itemTitleSecondFontColor">Title second font color</label><input type="text" name="itemTitleSecondFontColor" class="text ui-widget-content ui-corner-all" /></fieldset></form>').addClass(this.widgetEventPrefix);
this.element.append(a);this.element.addClass("dialog-form");this._createWidgets(this.element)};
primitives.orgeditor.DlgConfig.prototype._createWidgets=function(){var a,b,c,d;d=[];this.tips=this.element.find(".validateTips");this.itemTitleFirstFontColor=this.element.find("[name=itemTitleFirstFontColor]");this.itemTitleSecondFontColor=this.element.find("[name=itemTitleSecondFontColor]");for(b in primitives.common.Colors)primitives.common.Colors.hasOwnProperty(b)&&d.push(b);this.itemTitleFirstFontColor.autocomplete({source:d});this.itemTitleSecondFontColor.autocomplete({source:d});for(a in this.enums)if(this.enums.hasOwnProperty(a)){b=
this.enums[a];this[a]=this.element.find("[name="+a+"]");for(c in b.name)b.name.hasOwnProperty(c)&&(d=b.name[c],this[a].append(jQuery("<option value='"+d+"'>"+c+"</option>")));this[a].buttonset()}};primitives.orgeditor.DlgConfig.prototype._cleanLayout=function(){this.element.empty();this.element.removeClass("dialog-form")};
primitives.orgeditor.DlgConfig.prototype.open=function(a){var b=jQuery([]).add(this.itemTitleFirstFontColor).add(this.itemTitleSecondFontColor),c=this,a=void 0!==a?a:new primitives.orgdiagram.ItemConfig;this._updateWidgets(a);this.element.dialog({autoOpen:!1,height:400,width:350,modal:!0,title:"Chart options",buttons:{Save:function(){var d=!0;b.removeClass("ui-state-error");if(d=(d=(d=(d=d&&primitives.orgeditor.checkLength(c.tips,c.itemTitleFirstFontColor,"Title first font color",0,20))&&primitives.orgeditor.checkLength(c.tips,
c.itemTitleSecondFontColor,"Title second font color",0,20))&&primitives.orgeditor.checkColor(c.tips,c.itemTitleFirstFontColor,"Title first font color"))&&primitives.orgeditor.checkColor(c.tips,c.itemTitleSecondFontColor,"Title second font color"))c._updateConfig(a),jQuery(this).dialog("close"),c._trigger("update",null,a)},Cancel:function(){jQuery(this).dialog("close");c._trigger("cancel",null,a)}},close:function(){b.val("").removeClass("ui-state-error");c._trigger("cancel",null,a)}}).dialog("open")};
primitives.orgeditor.DlgConfig.prototype._updateWidgets=function(a){var b,c;for(b in this.enums)this.enums.hasOwnProperty(b)&&(c=a[b],null==c&&(c=this._getFirstEnumItem(this.enums[b].name)),this[b].val(c));this.itemTitleFirstFontColor.val(a.itemTitleFirstFontColor);this.itemTitleSecondFontColor.val(a.itemTitleSecondFontColor)};primitives.orgeditor.DlgConfig.prototype._getFirstEnumItem=function(a){for(var b in a)if(a.hasOwnProperty(b))return a[b];return null};
primitives.orgeditor.DlgConfig.prototype._updateConfig=function(a){var b,c;for(b in this.enums)this.enums.hasOwnProperty(b)&&(c=this[b].val(),a[b]=this.enums[b].isString?c:parseInt(c,10));a.itemTitleFirstFontColor=this.itemTitleFirstFontColor.val();a.itemTitleSecondFontColor=this.itemTitleSecondFontColor.val()};primitives.orgeditor.DlgConfig.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments)};(function(a){a.widget("ui.bpDlgConfig",new primitives.orgeditor.DlgConfig)})(jQuery);
primitives.orgeditor.DlgItemConfigOptions=function(){this.update=this.cancel=null};
primitives.orgeditor.DlgItemConfig=function(){this.widgetEventPrefix="bpdlgitemconfig";this.options=new primitives.orgeditor.DlgItemConfigOptions;this.defaultTemplateName=this.childrenPlacementType=this.adviserPlacementType=this.itemType=this.sortableList=this.groupTitleColor=this.groupTitle=this.readmoreurl=this.readmorelabel=this.image=this.email=this.phone=this.description=this.itemTitleColor=this.title=null;this.textFields={title:{title:"Title"},itemTitleColor:{title:"Title Color"},description:{title:"Description"},
phone:{title:"Phone"},email:{title:"E-mail"},groupTitle:{title:"Group Title"},groupTitleColor:{title:"Group Title Color"},image:{title:"Photo"},readmorelabel:{title:"Read more label"},readmoreurl:{title:"Read more URL"}};this.tips=null;this.enums={itemType:{name:{Regular:0,Assistant:1,Adviser:2,SubAssistant:4,SubAdviser:5},title:"Item type",isString:!1},adviserPlacementType:{name:primitives.orgdiagram.AdviserPlacementType,title:"Adviser placement",isString:!1},childrenPlacementType:{name:primitives.orgdiagram.ChildrenPlacementType,
title:"Children placement",isString:!1},templateName:{name:primitives.orgeditor.TemplateName,title:"Item template",isString:!0}}};primitives.orgeditor.DlgItemConfig.prototype._create=function(){this._createLayout()};primitives.orgeditor.DlgItemConfig.prototype.destroy=function(){this._cleanLayout()};
primitives.orgeditor.DlgItemConfig.prototype._createLayout=function(){new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());var a,b,c;c="<ul>"+('\t<li><a href="#'+this.widgetEventPrefix+'options">Options</a></li>');c+='\t<li><a href="#'+this.widgetEventPrefix+'order">Children order</a></li>';c+="</ul>";c+='<div id="'+this.widgetEventPrefix+'options">';c+='<p class="validateTips">All form fields are required.</p><form><fieldset>';for(a in this.textFields)this.textFields.hasOwnProperty(a)&&
(b=this.textFields[a],c+='<br/><label for="'+a+'">'+b.title+'</label><input type="text" name="'+a+'" class="text ui-widget-content ui-corner-all" />');for(a in this.enums)this.enums.hasOwnProperty(a)&&(b=this.enums[a],c+='<br/><label for="'+a+'">'+b.title+'</label><select class="text ui-widget-content ui-corner-all" style="padding:2px; margin:5px;" name="'+a+'"></select>');c+="</fieldset></form>";c+="</div>";c+='<div id="'+this.widgetEventPrefix+'order">';c+='<ul name="sortable" class="sortable"></ul>';
c+="</div>";a=jQuery(c).addClass(this.widgetEventPrefix);this.element.append(a);this.element.addClass("dialog-form");this._createWidgets()};
primitives.orgeditor.DlgItemConfig.prototype._createWidgets=function(){var a=[],b,c,d,e,f;this.element.tabs();this.sortableList=this.element.find("[name=sortable]");this.sortableList.sortable();this.sortableList.disableSelection();for(c in this.textFields)this.textFields.hasOwnProperty(c)&&(this[c]=this.element.find("[name="+c+"]"));this.tips=this.element.find(".validateTips");for(e in this.enums)if(this.enums.hasOwnProperty(e)){f=this.enums[e];this[e]=this.element.find("[name="+e+"]");for(c in f.name)f.name.hasOwnProperty(c)&&
(d=f.name[c],this[e].append(jQuery("<option value='"+d+"'>"+c+"</option>")));this[e].buttonset()}for(b in primitives.common.Colors)primitives.common.Colors.hasOwnProperty(b)&&a.push(b);this.itemTitleColor.autocomplete({source:a});this.groupTitleColor.autocomplete({source:a})};primitives.orgeditor.DlgItemConfig.prototype._cleanLayout=function(){this.element.empty();this.element.removeClass("dialog-form")};
primitives.orgeditor.DlgItemConfig.prototype.open=function(a){var b=this,a=void 0!==a?a:new primitives.orgdiagram.ItemConfig;this._updateWidgets(a);this.element.dialog({autoOpen:!1,height:400,width:350,modal:!0,title:"Item options",buttons:{Save:function(){var c=!0,d;for(d in b.textFields)b.textFields.hasOwnProperty(d)&&b[d].removeClass("ui-state-error");if(c=(c=(c=(c=(c=(c=c&&primitives.orgeditor.checkLength(b.tips,b.title,"Title",1,80))&&primitives.orgeditor.checkLength(b.tips,b.description,"Description",
0,400))&&primitives.orgeditor.checkLength(b.tips,b.itemTitleColor,"Title color",0,40))&&primitives.orgeditor.checkLength(b.tips,b.groupTitleColor,"Group title color",0,40))&&primitives.orgeditor.checkColor(b.tips,b.itemTitleColor,"Title color"))&&primitives.orgeditor.checkColor(b.tips,b.groupTitleColor,"Group title color"))b._updateItemConfig(a),jQuery(this).dialog("close"),b._trigger("update",null,a)},Cancel:function(){jQuery(this).dialog("close");b._trigger("cancel",null,a)}},close:function(){for(var c in b.textFields)b.textFields.hasOwnProperty(c)&&
b[c].val("").removeClass("ui-state-error");b._trigger("cancel",null,a)}}).dialog("open")};
primitives.orgeditor.DlgItemConfig.prototype._updateWidgets=function(a){var b,c,d;for(c in this.textFields)this.textFields.hasOwnProperty(c)&&this[c].val(a[c]);for(b in this.enums)this.enums.hasOwnProperty(b)&&(c=a[b],null==c&&(c=this._getFirstEnumItem(this.enums[b].name)),this[b].val(c));this.sortableList.empty();b=0;for(c=a.items.length;b<c;b+=1)d=a.items[b],this.sortableList.append(jQuery('<li id="'+b+'" class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>'+d.title+"</li>"))};
primitives.orgeditor.DlgItemConfig.prototype._getFirstEnumItem=function(a){for(var b in a)if(a.hasOwnProperty(b))return a[b];return null};
primitives.orgeditor.DlgItemConfig.prototype._updateItemConfig=function(a){var b,c,d,e;for(c in this.textFields)this.textFields.hasOwnProperty(c)&&(a[c]=this[c].val());for(b in this.enums)this.enums.hasOwnProperty(b)&&(c=this[b].val(),a[b]=this.enums[b].isString?c:parseInt(c,10));d=this.sortableList.sortable("toArray");if(0<d.length){e=[];b=0;for(c=d.length;b<c;b+=1)e.push(a.items[parseInt(d[b],10)]);a.items.length=0;a.items=e}};
primitives.orgeditor.DlgItemConfig.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments)};(function(a){a.widget("ui.bpDlgItemConfig",new primitives.orgeditor.DlgItemConfig)})(jQuery);primitives.orgeditor.DlgOrgDiagramOptions=function(){this.update=this.cancel=null};primitives.orgeditor.DlgOrgDiagram=function(){this.widgetEventPrefix="bpdlgorgdiagram";this.options=new primitives.orgeditor.DlgOrgDiagramOptions;this.orgdiagram=null};
primitives.orgeditor.DlgOrgDiagram.prototype._create=function(){this._createLayout()};primitives.orgeditor.DlgOrgDiagram.prototype.destroy=function(){this._cleanLayout()};
primitives.orgeditor.DlgOrgDiagram.prototype._createLayout=function(){var a;a=jQuery('<div class="bp-item" name="dlgorgdiagram" style="overflow: hidden; padding: 0px; margin: 0px; border: 0px;"></div>').addClass(this.widgetEventPrefix);this.element.append(a);this.element.css({overflow:"hidden"});this.element.addClass("dialog-form");this._createWidgets(this.element)};primitives.orgeditor.DlgOrgDiagram.prototype._createWidgets=function(){this.orgdiagram=this.element.find("[name=dlgorgdiagram]");this.orgdiagram.orgDiagram()};
primitives.orgeditor.DlgOrgDiagram.prototype._updateWidgets=function(a){this._updateLayout();this.orgdiagram.orgDiagram("option",a);this.orgdiagram.orgDiagram("update")};primitives.orgeditor.DlgOrgDiagram.prototype._updateLayout=function(){var a=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.orgdiagram.css(a.getCSS())};primitives.orgeditor.DlgOrgDiagram.prototype._cleanLayout=function(){this.element.empty();this.element.removeClass("dialog-form")};
primitives.orgeditor.DlgOrgDiagram.prototype.open=function(a,b){var c=jQuery([]),d=null,e=this,a=void 0!==a?a:new primitives.orgdiagram.Config;this.element.dialog({autoOpen:!1,minWidth:640,minHeight:480,modal:!0,title:"Select new parent",buttons:{Select:function(){var a=!0;c.removeClass("ui-state-error");d=e.orgdiagram.orgDiagram("option","cursorItem");if(a=!e._isParentOf(b,d))jQuery(this).dialog("close"),e._trigger("update",null,d)},Cancel:function(){jQuery(this).dialog("close");e._trigger("cancel")}},
close:function(){c.val("").removeClass("ui-state-error");e._trigger("cancel")},resizeStop:function(){e._updateLayout();e.orgdiagram.orgDiagram("update",primitives.orgdiagram.UpdateMode.Refresh)},open:function(){e._updateWidgets(a)}}).dialog("open")};primitives.orgeditor.DlgOrgDiagram.prototype._isParentOf=function(a,b){var c=!1,d,e,f;if(a===b)c=!0;else{d=0;for(e=a.items.length;d<e;d+=1)if(f=a.items[d],this._isParentOf(f,b)){c=!0;break}}return c};
primitives.orgeditor.DlgOrgDiagram.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments)};(function(a){a.widget("ui.bpDlgOrgDiagram",new primitives.orgeditor.DlgOrgDiagram)})(jQuery);
