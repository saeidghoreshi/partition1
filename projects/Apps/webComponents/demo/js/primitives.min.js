/*
 Basic Primitives orgDiagram v1.0.29

 (c) Adeltech Productions Inc

 License: http://www.basicprimitives.com/index.php?option=com_content&view=article&id=14&Itemid=18

*/
(function(){var a=function(a){var a=a.split("."),c=window,d;for(d=0;d<a.length;d+=1)c=c[a[d]]=c[a[d]]||{};return c};a("primitives.common");a("primitives.orgdiagram");a("primitives.text");a("primitives.callout")})();primitives.common.isNullOrEmpty=function(a){var b=!0;void 0!==a&&null!==a&&(a=a.toString(),0<a.length&&(b=!1));return b};primitives.common.hashCode=function(a){var b=0,c,d;if(0<a.length)for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b=(b<<5)-b+c,b&=b;return b};
primitives.common.attr=function(a,b){var c,d;if(a.hasOwnProperty("attrHash"))for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.attrHash[c]!=d&&(a.attrHash[c]=d,a.attr(c,d)));else a.attr(b),a.attrHash=b};primitives.common.css=function(a,b){var c,d;if(a.hasOwnProperty("cssHash"))for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.cssHash[c]!=d&&(a.cssHash[c]=d,a.css(c,d)));else a.css(b),a.cssHash=b};
primitives.common.stopPropagation=function(a){void 0!==a.stopPropagation?a.stopPropagation():void 0!==a.cancelBubble?a.cancelBubble=!0:void 0!==a.preventDefault&&a.preventDefault()};primitives.common.indexOf=function(a,b){var c,d;for(c=0;c<a.length;c+=1)if(d=a[c],d===b)return c;return-1};primitives.common._supportsSVG=null;
primitives.common.supportsSVG=function(){null===primitives.common._supportsSVG&&(primitives.common._supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0"));return primitives.common._supportsSVG};primitives.common._supportsVML=null;
primitives.common.supportsVML=function(){var a,b;null===primitives.common._supportsVML&&(primitives.common._supportsVML=!1,jQuery.support.opacity||(a=document.createElement("div"),a=document.body.appendChild(a),a.innerHTML='<v:shape adj="1" />',b=a.firstChild,b.style.behavior="url(#default#VML)",primitives.common._supportsVML=b?"object"===typeof b.adj:!1,a.parentNode.removeChild(a)));return primitives.common._supportsVML};primitives.common._supportsCanvas=null;
primitives.common.supportsCanvas=function(){null===primitives.common._supportsCanvas&&(primitives.common._supportsCanvas=!!window.HTMLCanvasElement);return primitives.common._supportsCanvas};
primitives.common.createGraphics=function(a,b){var c=null,d,e;d=[a];for(e in primitives.common.GraphicsType)primitives.common.GraphicsType.hasOwnProperty(e)&&d.push(primitives.common.GraphicsType[e]);for(e=0;null===c&&e<d.length;e+=1)switch(d[e]){case 2:primitives.common.supportsVML()&&(c=new primitives.common.VmlGraphics(b));break;case 0:primitives.common.supportsSVG()&&(c=new primitives.common.SvgGraphics(b));break;case 1:primitives.common.supportsCanvas()&&(c=new primitives.common.CanvasGraphics(b))}return c};
primitives.common.getColorHexValue=function(a){var b,c,d;if("#"===a.substr(0,1))return a;b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null!==b&&0<b.length)return a=parseInt(b[2],10),c=parseInt(b[3],10),d=parseInt(b[4],10),a=(a<<16|c<<8|d).toString(16),b[1]+"000000".substr(0,6-a.length)+a;if(void 0===primitives.common.ColorHexs)for(c in primitives.common.ColorHexs={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(c)&&(primitives.common.ColorHexs[c.toUpperCase()]=primitives.common.Colors[c]);
return primitives.common.ColorHexs[a.toUpperCase()]};primitives.common.getColorName=function(a){var b,a=primitives.common.getColorHexValue(a);if(void 0===primitives.common.ColorNames)for(b in primitives.common.ColorNames={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(b)&&(primitives.common.ColorNames[primitives.common.Colors[b]]=b);return primitives.common.ColorNames[a]};primitives.common.getRed=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(1,2),16):null};
primitives.common.getGreen=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(3,2),16):null};primitives.common.getBlue=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(5,2),16):null};
primitives.common.beforeOpacity=function(a,b){var c=primitives.common,d,e,a=c.getColorHexValue(a);d=Math.ceil((c.getRed(a)-255*(1-b))/b);e=Math.ceil((c.getRed(a)-255*(1-b))/b);c=Math.ceil((c.getRed(a)-255*(1-b))/b);d=(d<<16|e<<8|c).toString(16);return"#"+"000000".substr(0,6-d.length)+d};
primitives.common.highestContrast=function(a,b,c){var d=b,e=primitives.common,f=a+","+b+","+c;void 0===e.highestContrasts&&(e.highestContrasts={});e.highestContrasts.hasOwnProperty(f)?d=e.highestContrasts[f]:(e.luminosity(b,a)<e.luminosity(c,a)&&(d=c),e.highestContrasts[f]=d);return d};
primitives.common.luminosity=function(a,b){var c=primitives.common,d=c.getColorHexValue(a),e=c.getColorHexValue(b),d=0.2126*Math.pow(c.getRed(d)/255,2.2)+0.7152*Math.pow(c.getRed(d)/255,2.2)+0.0722*Math.pow(c.getRed(d)/255,2.2),c=0.2126*Math.pow(c.getRed(e)/255,2.2)+0.7152*Math.pow(c.getRed(e)/255,2.2)+0.0722*Math.pow(c.getRed(e)/255,2.2);return d>c?(d+0.05)/(c+0.05):(c+0.05)/(d+0.05)};primitives.orgdiagram.AdviserPlacementType={Auto:0,Left:2,Right:3};
primitives.orgdiagram.UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2};primitives.text.TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2};primitives.orgdiagram.SelectionPathMode={None:0,FullStack:1};primitives.common.SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4};primitives.common.RenderingMode={Create:0,Update:1};primitives.common.PlacementType={Auto:0,Top:1,TopRight:2,Right:3,BottomRight:4,Bottom:5,BottomLeft:6,Left:7,TopLeft:8};
primitives.orgdiagram.PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3};primitives.common.VerticalAlignmentType={Top:0,Middle:1,Bottom:2};primitives.orgdiagram.OrientationType={Top:0,Bottom:1,Left:2,Right:3};primitives.orgdiagram.ItemType={Regular:0,Assistant:1,Adviser:2,Invisible:3,SubAssistant:4,SubAdviser:5};primitives.common.HorizontalAlignmentType={Center:0,Left:1,Right:2};primitives.common.GraphicsType={SVG:0,Canvas:1,VML:2};primitives.common.Enabled={Auto:0,True:1,False:2};
primitives.orgdiagram.ConnectorType={Squared:0,Angular:1,Curved:2};
primitives.common.Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",
DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",
Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",
LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",
Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",
SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"};primitives.orgdiagram.ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3};primitives.orgdiagram.Layers={Connector:1,Highlight:2,Marker:3,Cursor:4,Item:5,Annotation:6};
primitives.orgdiagram.Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4};primitives.orgdiagram.EventArgs=function(){this.name=this.position=this.parentItem=this.context=this.oldContext=null;this.cancel=!1};primitives.common.RenderEventArgs=function(){this.renderingMode=this.templateName=this.context=this.element=null;this.isSelected=this.isCursor=!1};
primitives.common.Callout=function(a){this.m_graphics=a;this.pointerPlacement=0;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.pointerWidth="10%";this.borderColor="#000000";this.fillColor="#d3d3d3";this.m_map=[[8,7,6],[1,null,5],[2,3,4]]};
primitives.common.Callout.prototype.draw=function(a,b){var b=(new primitives.common.Rect(b)).offset(this.offset),c=new primitives.common.Point(b.x,b.y),d=new primitives.common.Point(b.right(),b.y),e=new primitives.common.Point(b.right(),b.bottom()),f=new primitives.common.Point(b.left(),b.bottom()),g=[null,null,null,null,null,null,null,null],f=[c,d,e,f],d=this.m_graphics.getPxSize(this.cornerRadius,Math.min(c.distanceTo(d),d.distanceTo(e))),h;null!==a&&(c=0===this.pointerPlacement?this._getPlacement(a,
c,e):this.pointerPlacement,null!==c&&(g[c]=a));c=[];for(h=0;h<f.length;h+=1)this._drawSegment(c,f[0],f[1],f[2],this.pointerWidth,d,g[1],g[2]),e=f.shift(),f.push(e),e=g.shift(),g.push(e),e=g.shift(),g.push(e);g={};null!==this.fillColor&&(g.fillColor=this.fillColor,g.opacity=this.opacity);null!==this.borderColor&&(g.borderColor=this.borderColor);g.lineWidth=this.lineWidth;this.m_graphics.polyline(c,g)};
primitives.common.Callout.prototype._getPlacement=function(a,b,c){var d=null,e=null,d=a.x<b.x?0:a.x>c.x?2:1,e=a.y<b.y?0:a.y>c.y?2:1;return this.m_map[d][e]};
primitives.common.Callout.prototype._drawSegment=function(a,b,c,d,e,f,g,h){var j=this._offsetPoint(b,c,f),m=this._offsetPoint(c,b,f),d=this._offsetPoint(c,d,f),e=this.m_graphics.getPxSize(e,b.distanceTo(c)/2);0===a.length&&a.push(new primitives.common.MoveSegment(j));null!==g&&(j=this._betweenPoint(b,c),b=this._offsetPoint(j,b,e),e=this._offsetPoint(j,c,e),a.push(new primitives.common.LineSegment(b)),a.push(new primitives.common.LineSegment(g)),a.push(new primitives.common.LineSegment(e)));a.push(new primitives.common.LineSegment(m));
null!==h?(a.push(new primitives.common.LineSegment(h)),a.push(new primitives.common.LineSegment(d))):a.push(new primitives.common.QuadraticArcSegment(c,d))};primitives.common.Callout.prototype._betweenPoint=function(a,b){return new primitives.common.Point((a.x+b.x)/2,(a.y+b.y)/2)};primitives.common.Callout.prototype._offsetPoint=function(a,b,c){var d=new primitives.common.Point(a);a.x<b.x?d.x+=c:a.x>b.x?d.x-=c:d.y=a.y<b.y?d.y+c:d.y-c;return d};
primitives.common.Point=function(a,b){this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;break;case 2:this.x=a,this.y=b}};primitives.common.Point.prototype.distanceTo=function(a,b){var c=0,d=0;switch(arguments.length){case 1:c=a.x;d=a.y;break;case 2:c=a,d=b}c=this.x-c;d=this.y-d;return Math.sqrt(c*c+d*d)};primitives.common.Point.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");return b+="top:"+this.y+a+";"};
primitives.common.CubicArcSegment=function(a,b,c,d,e,f){this.cpY2=this.cpX2=this.cpY1=this.cpX1=this.y=this.x=null;switch(arguments.length){case 3:this.x=c.x;this.y=c.y;this.cpX1=a.x;this.cpY1=a.y;this.cpX2=b.x;this.cpY2=b.y;break;case 6:this.cpX1=a,this.cpY1=b,this.cpX2=c,this.cpY2=d,this.x=e,this.y=f}this.segmentType=3};primitives.common.DotSegment=function(a,b,c){this.segmentType=4;this.x=a;this.y=b;this.radius=c};
primitives.common.LineSegment=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=0};primitives.common.LineSegment.prototype=new primitives.common.Point;primitives.common.MoveSegment=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=1};primitives.common.LineSegment.prototype=new primitives.common.Point;
primitives.common.QuadraticArcSegment=function(a,b,c,d){this.cpY=this.cpX=this.y=this.x=null;switch(arguments.length){case 2:this.x=b.x;this.y=b.y;this.cpX=a.x;this.cpY=a.y;break;case 4:this.cpX=a,this.cpY=b,this.x=c,this.y=d}this.segmentType=2};
primitives.common.Rect=function(a,b,c,d){this.height=this.width=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;break;case 2:this.x=Math.min(a.x,b.x);this.y=Math.min(a.y,b.y);this.width=Math.abs(b.x-a.x);this.height=Math.abs(b.y-a.y);break;case 4:this.x=a,this.y=b,this.width=c,this.height=d}};primitives.common.Rect.prototype.left=function(){return this.x};primitives.common.Rect.prototype.top=function(){return this.y};
primitives.common.Rect.prototype.right=function(){return this.x+this.width};primitives.common.Rect.prototype.bottom=function(){return this.y+this.height};primitives.common.Rect.prototype.verticalCenter=function(){return this.y+this.height/2};primitives.common.Rect.prototype.horizontalCenter=function(){return this.x+this.width/2};primitives.common.Rect.prototype.isEmpty=function(){return null===this.x||null===this.y||null===this.width||null===this.height||0>this.width||0>this.height};
primitives.common.Rect.prototype.offset=function(a,b,c,d){switch(arguments.length){case 1:this.x-=a;this.y-=a;this.width+=2*a;this.height+=2*a;break;case 4:this.x-=a,this.y-=b,this.width=this.width+a+c,this.height=this.height+b+d}return this};primitives.common.Rect.prototype.translate=function(a,b){this.x+=a;this.y+=b;return this};primitives.common.Rect.prototype.invert=function(){var a=this.width,b=this.x;this.width=this.height;this.height=a;this.x=this.y;this.y=b;return this};
primitives.common.Rect.prototype.contains=function(a,b){switch(arguments.length){case 1:return this.x<=a.x&&a.x<=this.x+this.width&&this.y<=a.y&&a.y<=this.y+this.height;case 2:return this.x<=a&&a<=this.x+this.width&&this.y<=b&&b<=this.y+this.height;default:return!1}};
primitives.common.Rect.prototype.cropByRect=function(a){this.x<a.x&&(this.width-=a.x-this.x,this.x=a.x);this.right()>a.right()&&(this.width-=this.right()-a.right());this.y<a.y&&(this.height-=a.y-this.y,this.y=a.y);this.bottom()>a.bottom()&&(this.height-=this.bottom()-a.bottom());this.isEmpty()&&(this.height=this.width=this.y=this.x=null);return this};
primitives.common.Rect.prototype.addRect=function(a,b,c,d){var e,f;switch(arguments.length){case 1:a.isEmpty()||(this.isEmpty()?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):(e=Math.max(this.right(),a.right()),f=Math.max(this.bottom(),a.bottom()),this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.width=e-this.x,this.height=f-this.y));break;case 2:this.isEmpty()?(this.x=a,this.y=b,this.height=this.width=0):(e=Math.max(this.right(),a),f=Math.max(this.bottom(),b),this.x=Math.min(this.x,
a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y);break;case 4:this.isEmpty()?(this.x=a,this.y=b,this.width=c,this.height=d):(e=Math.max(this.right(),a+c),f=Math.max(this.bottom(),b+d),this.x=Math.min(this.x,a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y)}return this};primitives.common.Rect.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};
primitives.common.Rect.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");b+="top:"+this.y+a+";";b+="width:"+this.width+a+";";return b+="height:"+this.height+a+";"};primitives.common.Size=function(a,b){this.height=this.width=0;switch(arguments.length){case 1:this.width=a.width;this.height=a.height;break;case 2:this.width=a,this.height=b}};primitives.common.Size.prototype.invert=function(){var a=this.width;this.width=this.height;this.height=a;return this};
primitives.common.Thickness=function(a,b,c,d){this.left=a;this.top=b;this.right=c;this.bottom=d};primitives.common.Thickness.prototype.isEmpty=function(){return 0===this.left&&0===this.top&&0===this.right&&0===this.bottom};primitives.common.Thickness.prototype.toString=function(a){a=void 0!==a?a:"px";return this.left+a+", "+this.top+a+", "+this.right+a+", "+this.bottom+a};
primitives.common.Graphics=function(a){this.m_widget=a;this.m_placeholders={};this.m_activePlaceholder=null;this.m_cache=new primitives.common.Cache;this.boxModel=jQuery.support.boxModel;this.graphicsType=null;this.hasGraphics=!1};
primitives.common.Graphics.prototype.clean=function(){var a,b,c,d;this.m_cache.clear();this.m_widget=this.m_cache=null;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a)){b=this.m_placeholders[a];for(c in b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],d.canvas.remove(),d.canvas=null);b.layers.length=0;b.activeLayer=null;b.size=null;b.rect=null;b.div=null}this.m_placeholders.length=0;this.m_activePlaceholder=null};
primitives.common.Graphics.prototype.resize=function(a){var b,c;switch(arguments.length){case 0:for(b in this.m_placeholders)this.m_placeholders.hasOwnProperty(b)&&(c=this.m_placeholders[b],this.resizePlaceholder(c));break;case 1:c=this.m_placeholders[a],null!=c&&this.resizePlaceholder(c)}};primitives.common.Graphics.prototype.setTransform=function(a,b,c,d){a=this.m_placeholders[a];null!=a&&(a.invertArea=b,a.invertHorizontally=c,a.invertVertically=d)};
primitives.common.Graphics.prototype.resizePlaceholder=function(a){var b,c;a.size=new primitives.common.Size(a.div.width(),a.div.height());a.rect=new primitives.common.Rect(0,0,a.size.width,a.size.height);for(b in a.layers)a.layers.hasOwnProperty(b)&&(c=a.layers[b],-1!==c.name&&c.canvas.css({position:"absolute",width:"0px",height:"0px"}))};primitives.common.Graphics.prototype.begin=function(){this.m_cache.begin()};primitives.common.Graphics.prototype.end=function(){this.m_cache.end()};
primitives.common.Graphics.prototype.reset=function(a,b){var c="none",d=-1;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.m_cache.reset(c,d)};primitives.common.Graphics.prototype.activate=function(a,b){switch(arguments.length){case 1:"string"===typeof a?(this._activatePlaceholder(a),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(a));break;case 2:this._activatePlaceholder(a),this._activateLayer(b)}return this.m_activePlaceholder};
primitives.common.Graphics.prototype._activatePlaceholder=function(a){var b=this.m_placeholders[a],c;void 0===b&&(c="none"===a?this.m_widget.element:this.m_widget.element.find("."+a),b=new primitives.common.Placeholder(a),b.div=c,b.size=new primitives.common.Size(c.innerWidth(),c.innerHeight()),b.rect=new primitives.common.Rect(0,0,b.size.width,b.size.height),this.m_placeholders[a]=b);this.m_activePlaceholder=b};
primitives.common.Graphics.prototype._activateLayer=function(a){var b=this.m_activePlaceholder.layers[a],c,d,e,f;if(void 0===b){c=this.m_activePlaceholder;if(-1===a)b=new primitives.common.Layer(a),b.canvas=c.div;else{d=jQuery("<div></div>");d.addClass("Layer"+a);new primitives.common.Rect(c.rect);d.css({position:"absolute",width:"0px",height:"0px"});e=null;for(f in c.layers)c.layers.hasOwnProperty(f)&&(b=c.layers[f],b.name<a&&(e=null!==e?Math.max(e,b.name):b.name));b=new primitives.common.Layer(a);
b.canvas=d;null===e?c.div.prepend(b.canvas[0]):b.canvas.insertAfter(c.layers[e].canvas)}c.layers[a]=b}this.m_activePlaceholder.activeLayer=b};
primitives.common.Graphics.prototype.text=function(a,b,c,d,e,f,g,h,j){var m=this.m_activePlaceholder,k={position:"absolute",padding:0,margin:0,"text-align":this._getTextAlign(g),"font-size":j["font-size"],"font-family":j["font-family"],"font-weight":j["font-weight"],"font-style":j["font-style"],color:j["font-color"]},l="",i,n;m.transformRect(a,b,c,d,this,function(a,b,c,d){switch(f){case 0:k.left=a;k.top=b;k.width=c;k.height=d;break;case 1:k.left=a+Math.round(c/2-d/2);k.top=b+Math.round(d/2-c/2);k.width=
d;k.height=c;l="rotate(-90deg)";break;case 2:k.left=a+Math.round(c/2-d/2),k.top=b+Math.round(d/2-c/2),k.width=d,k.height=c,l="rotate(90deg)"}k["-webkit-transform-origin"]="center center";k["-moz-transform-origin"]="center center";k["-o-transform-origin"]="center center";k["-ms-transform-origin"]="center center";k["-webkit-transform"]=l;k["-moz-transform"]=l;k["-o-transform"]=l;k["-ms-transform"]=l;k.transform=l;k["max-width"]=k.width;k["max-height"]=k.height;e=e.replace(RegExp("\n","g"),"<br/>");
switch(h){case 0:i=this.m_cache.get(m.name,m.activeLayer.name,"text");null===i?(i=jQuery("<div></div>"),i.css(k),i.html(e),m.activeLayer.canvas.append(i),this.m_cache.put(m.name,m.activeLayer.name,"text",i)):(i.css(k),i.html(e));break;default:k["border-collapse"]="collapse",n={"vertical-align":this._getVerticalAlignment(h),padding:0},i=this.m_cache.get(m.name,m.activeLayer.name,"textintable"),null===i?(i=jQuery("<table><tbody><tr><td></td></tr></tbody></table>"),primitives.common.css(i,k),i.find("td").css(n).html(e),
m.activeLayer.canvas.append(i),this.m_cache.put(m.name,m.activeLayer.name,"textintable",i)):(primitives.common.css(i,k),i.find("td").css(n).html(e))}})};primitives.common.Graphics.prototype._getTextAlign=function(a){var b=null;switch(a){case 0:b="center";break;case 1:b="left";break;case 2:b="right"}return b};primitives.common.Graphics.prototype._getVerticalAlignment=function(a){var b=null;switch(a){case 1:b="middle";break;case 0:b="top";break;case 2:b="bottom"}return b};
primitives.common.Graphics.prototype.polyline=function(a,b){var c=null,d=null,e,f;for(e=0;e<a.length;e+=1)switch(f=a[e],f.segmentType){case 1:c=Math.round(f.x)+0.5;d=Math.round(f.y)+0.5;break;case 0:this.rightAngleLine(c,d,Math.round(f.x)+0.5,Math.round(f.y)+0.5,b);break;case 4:this.dot(f.x,f.y,f.radius,b)}};
primitives.common.Graphics.prototype.dot=function(a,b,c,d){var e=this.m_activePlaceholder,f=this.m_cache.get(e.name,e.activeLayer.name,"dot");e.transformPoint(a,b,this,function(a,b){var j={position:"absolute",width:2*c,top:b-c+0.5,left:a-c+0.5,padding:0,margin:0,"line-height":"0px",overflow:"hidden",height:2*c,background:d.fillColor,"-moz-border-radius":c,"-webkit-border-radius":c,"-khtml-border-radius":c,"border-radius":c,"font-size":"0px","border-style":"None","border-width":"0px"};null===f?(f=
jQuery("<div></div>"),primitives.common.css(f,j),e.activeLayer.canvas.append(f),this.m_cache.put(e.name,e.activeLayer.name,"dot",f)):primitives.common.css(f,j)})};
primitives.common.Graphics.prototype.rightAngleLine=function(a,b,c,d,e){var f=this.m_activePlaceholder;f.transformPoints(a,b,c,d,this,function(a,b,c,d){var k=Math.abs(d-b)>Math.abs(c-a),l=e.lineWidth,i={position:"absolute",top:Math.round(Math.min(b,d)-(k?0:l/2)),left:Math.round(Math.min(a,c)-(k?l/2:0)),padding:0,margin:0,opacity:0.5,"line-height":"0px",overflow:"hidden",background:e.borderColor,"font-size":"0px"};k?(i.width=l,i.height=Math.abs(Math.round(d-b))):(i.width=Math.abs(Math.round(c-a)),
i.height=l);a=this.m_cache.get(f.name,f.activeLayer.name,"rect");null===a?(a=jQuery("<div></div>"),primitives.common.css(a,i),f.activeLayer.canvas.append(a),this.m_cache.put(f.name,f.activeLayer.name,"rect",a)):primitives.common.css(a,i)})};
primitives.common.Graphics.prototype.template=function(a,b,c,d,e,f,g,h,j,m,k,l,i){var n=this.m_activePlaceholder,p;n.transformRect(a,b,c,d,this,function(a,b){var c="template"+(null!==m)?m:primitives.common.hashCode(j),d=0;p=this.m_cache.get(n.name,n.activeLayer.name,c);null!==i&&void 0!==i["border-width"]&&(d=this.boxModel?this.getPxSize(i["border-width"]):0);d={width:g-d+"px",height:h-d+"px",top:b+f+"px",left:a+e+"px"};jQuery.extend(d,i);null===l&&(l=new primitives.common.RenderEventArgs);null===
p?(p=jQuery(j),jQuery.extend(d,{position:"absolute",overflow:"hidden",padding:"0px",margin:"0px"},i),primitives.common.css(p,d),l.element=p,l.renderingMode=0,null!==k&&this.m_widget._trigger(k,null,l),n.activeLayer.canvas.append(p),this.m_cache.put(n.name,n.activeLayer.name,c,p)):(l.element=p,l.renderingMode=1,primitives.common.css(p,d),null!==k&&this.m_widget._trigger(k,null,l))});return p};
primitives.common.Graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};primitives.common.Cache=function(){this.threshold=20;this.m_visible={};this.m_invisible={}};
primitives.common.Cache.prototype.begin=function(){var a,b,c,d;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(c=this.m_visible[a][b].length-1;0<=c;c-=1)d=this.m_visible[a][b][c],d.css({visibility:"hidden"}),this.m_invisible[a][b].push(d);this.m_visible[a][b].length=0}};
primitives.common.Cache.prototype.end=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)&&this.m_invisible[a][b].length>this.threshold)for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()};
primitives.common.Cache.prototype.reset=function(a,b){var a=a+"-"+b,c=null,d,e;for(d in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(d)){for(e=this.m_visible[a][d].length-1;0<=e;e-=1)c=this.m_visible[a][d][e],this.m_invisible[a][d].push(c),c.css({visibility:"hidden"});this.m_visible[a][d].length=0}};
primitives.common.Cache.prototype.clear=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(;void 0!==(c=this.m_visible[a][b].pop());)c.remove();for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()}};
primitives.common.Cache.prototype.get=function(a,b,c){a=a+"-"+b;b=null;void 0===this.m_visible[a]&&(this.m_visible[a]={},this.m_invisible[a]={});void 0===this.m_visible[a][c]&&(this.m_visible[a][c]=[],this.m_invisible[a][c]=[]);b=this.m_invisible[a][c].pop()||null;null!==b&&(this.m_visible[a][c].push(b),b.css({visibility:"inherit"}));return b};primitives.common.Cache.prototype.put=function(a,b,c,d){this.m_visible[a+"-"+b][c].push(d)};
primitives.common.CanvasGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.graphicsType=1;this.m_maximum=6E3};primitives.common.CanvasGraphics.prototype=new primitives.common.Graphics;
primitives.common.CanvasGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&(d.canvascanvas.remove(),d.canvascanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.CanvasGraphics.prototype._activatePlaceholder=function(a){var b,c,d;this.parent._activatePlaceholder.apply(this,arguments);b=this.m_activePlaceholder;c=b.size.width;d=b.size.height;b.hasGraphics=c>this.m_maximum||d>this.m_maximum?!1:!0};
primitives.common.CanvasGraphics.prototype.resizePlaceholder=function(a){var b,c,d,e;this.parent.resizePlaceholder.apply(this,arguments);d=a.size.width;e=a.size.height;for(b in a.layers)a.layers.hasOwnProperty(b)&&(c=a.layers[b],null!==c.canvascanvas&&(c.canvascanvas.css({position:"absolute",width:d+"px",height:e+"px"}),c.canvascanvas.attr({width:d+"px",height:e+"px"})))};
primitives.common.CanvasGraphics.prototype.begin=function(){var a,b,c,d,e,f;this.parent.begin.apply(this);for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],e=b.size.width,f=b.size.height,b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,e,f))};
primitives.common.Graphics.prototype._getContext=function(a,b){var c=a.size.width,d=a.size.height;null===b.canvascanvas&&(b.canvascanvas=jQuery("<canvas></canvas>"),b.canvascanvas.attr({width:c+"px",height:d+"px"}),a.activeLayer.canvas.prepend(b.canvascanvas),b.canvascontext=b.canvascanvas[0].getContext("2d"));return b.canvascontext};
primitives.common.CanvasGraphics.prototype.reset=function(a,b){var c="none",d=-1,e,f;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.parent.reset.apply(this,arguments);e=this.m_placeholders[c];void 0!==e&&(c=e.size.width,f=e.size.height,d=e.layers[d],void 0!==d&&null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,c,f))};
primitives.common.CanvasGraphics.prototype.polyline=function(a,b){var c=this.m_activePlaceholder,d,e,f;if(c.hasGraphics){d=c.activeLayer;e=this._getContext(c,d);e.save();void 0!==b.lineWidth&&void 0!==b.borderColor?(e.strokeStyle=b.borderColor,e.lineWidth=b.lineWidth):(e.lineWidth=0,e.strokeStyle="Transparent");e.beginPath();for(d=0;d<a.length;d+=1)switch(f=a[d],f.segmentType){case 1:c.transformPoint(Math.floor(f.x)+0.5,Math.floor(f.y)+0.5,this,function(a,b){e.moveTo(a,b)});break;case 0:c.transformPoint(Math.floor(f.x)+
0.5,Math.floor(f.y)+0.5,this,function(a,b){e.lineTo(a,b)});break;case 4:c.transformPoint(Math.floor(f.x)+0.5,Math.floor(f.y)+0.5,this,function(a,b){e.moveTo(a,b);e.arc(a,b,Math.floor(f.radius),0,2*Math.PI,!1)});break;case 2:c.transformPoints(Math.floor(f.cpX)+0.5,Math.floor(f.cpY)+0.5,Math.floor(f.x)+0.5,Math.floor(f.y)+0.5,this,function(a,b,c,d){e.quadraticCurveTo(a,b,c,d)});break;case 3:c.transform3Points(Math.floor(f.cpX1)+0.5,Math.floor(f.cpY1)+0.5,Math.floor(f.cpX2)+0.5,Math.floor(f.cpY2)+0.5,
Math.floor(f.x)+0.5,Math.floor(f.y)+0.5,this,function(a,b,c,d,f,l){e.bezierCurveTo(a,b,c,d,f,l)})}void 0!==b.lineWidth&&e.stroke();void 0!==b.fillColor&&(e.fillStyle=b.fillColor,e.globalAlpha=b.opacity,e.fill());e.restore()}else this.parent.polyline.apply(this,arguments)};primitives.common.Element=function(a,b){this.name=this.ns=null;this.attr={};this.style={};this.children=[];switch(arguments.length){case 1:this.name=a;break;case 2:this.ns=a,this.name=b}};
primitives.common.Element.prototype.setAttribute=function(a,b){this.attr[a]=b};primitives.common.Element.prototype.appendChild=function(a){this.children[this.children.length]=a};
primitives.common.Element.prototype.create=function(a){var b=null,c,d,b=null!==this.ns?document.createElementNS(this.ns,this.name):document.createElement(this.name);for(c in this.attr)this.attr.hasOwnProperty(c)&&(void 0!==a?b[c]=this.attr[c]:b.setAttribute(c,this.attr[c]));for(c in this.style)this.style.hasOwnProperty(c)&&(b.style[c]=this.style[c]);for(d=0;d<this.children.length;d+=1)c=this.children[d],"string"===typeof c?b.appendChild(document.createTextNode(c)):b.appendChild(c.create(a));return b};
primitives.common.Element.prototype.update=function(a,b){var c,d,e;for(c in this.style)this.style.hasOwnProperty(c)&&(d=this.style[c],a.style[c]!==d&&(a.style[c]=d));for(c in this.attr)this.attr.hasOwnProperty(c)&&(d=this.attr[c],void 0!==b?a[c]!==d&&(a[c]=d):a.getAttribute(c)!==d&&a.setAttribute(c,d));c=this.children.length;for(d=0;d<c;d+=1)e=this.children[d],"string"===typeof e?a.innerHtml!==e&&(a.innerHtml=e):this.children[d].update(a.children[d],b)};
primitives.common.Layer=function(a){this.name=a;this.svgcanvas=this.canvascanvas=this.canvas=null};primitives.common.Placeholder=function(a){this.name=a;this.invertVertically=this.invertHorizontally=this.invertArea=null;this.layers={};this.div=this.rect=this.size=this.activeLayer=null;this.hasGraphics=!0};
primitives.common.Placeholder.prototype.transformPointBack=function(a,b,c,d){var e;this.invertHorizontally&&(a=this.size.width-a);this.invertVertically&&(b=this.size.height-b);this.invertArea&&(e=a,a=b,b=e);d.call(c,a,b)};primitives.common.Placeholder.prototype.transformPoint=function(a,b,c,d){var e;this.invertArea&&(e=a,a=b,b=e);this.invertHorizontally&&(a=this.size.width-a);this.invertVertically&&(b=this.size.height-b);d.call(c,a,b)};
primitives.common.Placeholder.prototype.transformPoints=function(a,b,c,d,e,f){var g;this.invertArea&&(g=a,a=b,b=g,g=c,c=d,d=g);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d);f.call(e,a,b,c,d)};
primitives.common.Placeholder.prototype.transform3Points=function(a,b,c,d,e,f,g,h){var j;this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=e,e=f,f=j);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c,e=this.size.width-e);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d,f=this.size.height-f);h.call(g,a,b,c,d,e,f)};
primitives.common.Placeholder.prototype.transformRect=function(a,b,c,d,e,f){var g;this.invertArea&&(g=a,a=b,b=g,g=c,c=d,d=g);this.invertHorizontally&&(a=this.size.width-a-c);this.invertVertically&&(b=this.size.height-b-d);f.call(e,a,b,c,d)};primitives.common.SvgGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this._svgxmlns="http://www.w3.org/2000/svg";this.graphicsType=0;this.hasGraphics=!0};
primitives.common.SvgGraphics.prototype=new primitives.common.Graphics;primitives.common.SvgGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.svgcanvas&&(d.svgcanvas.remove(),d.svgcanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.SvgGraphics.prototype.resizePlaceholder=function(a){var b,c,d;this.parent.resizePlaceholder.apply(this,arguments);for(b in a.layers)a.layers.hasOwnProperty(b)&&(c=a.layers[b],null!==c.svgcanvas&&(d={position:"absolute",width:a.size.width+"px",height:a.size.height+"px"},c.svgcanvas.css(d)))};
primitives.common.SvgGraphics.prototype._getCanvas=function(){var a=this.m_activePlaceholder,b=a.activeLayer,c=a.rect;null===b.svgcanvas&&(b.svgcanvas=jQuery('<svg version = "1.1"></svg>'),b.svgcanvas.attr({viewBox:c.x+" "+c.y+" "+c.width+" "+c.height}),b.svgcanvas.css({width:c.width+"px",height:c.height+"px"}),a.activeLayer.canvas.prepend(b.svgcanvas));return b.svgcanvas};
primitives.common.SvgGraphics.prototype.polyline=function(a,b){var c=this.m_activePlaceholder,d,e,f,g;d=new primitives.common.Element(this._svgxmlns,"path");void 0!==b.fillColor?(d.setAttribute("fill",b.fillColor),d.setAttribute("fill-opacity",b.opacity)):d.setAttribute("fill-opacity",0);void 0!==b.lineWidth&&void 0!==b.borderColor?(d.setAttribute("stroke",b.borderColor),d.setAttribute("stroke-width",b.lineWidth)):(d.setAttribute("stroke","transparent"),d.setAttribute("stroke-width",0));e="";for(f=
0;f<a.length;f+=1)switch(g=a[f],g.segmentType){case 1:c.transformPoint(Math.floor(g.x)+0.5,Math.floor(g.y)+0.5,this,function(a,b){e+="M"+a+" "+b});break;case 0:c.transformPoint(Math.floor(g.x)+0.5,Math.floor(g.y)+0.5,this,function(a,b){e+="L"+a+" "+b});break;case 2:c.transformPoints(Math.floor(g.cpX)+0.5,Math.floor(g.cpY)+0.5,Math.floor(g.x)+0.5,Math.floor(g.y)+0.5,this,function(a,b,c,d){e+="Q"+a+" "+b+" "+c+" "+d});break;case 4:c.transformPoints(Math.floor(g.x-g.radius)+0.5,Math.floor(g.y)+0.5,Math.floor(g.x+
g.radius)+0.5,Math.floor(g.y)+0.5,this,function(a,b,c,d){e+="M"+a+" "+b;e+="A"+g.radius+" "+g.radius+" 0 1 0 "+c+" "+d;e+="A"+g.radius+" "+g.radius+" 0 1 0 "+a+" "+b});break;case 3:c.transform3Points(Math.floor(g.cpX1)+0.5,Math.floor(g.cpY1)+0.5,Math.floor(g.cpX2)+0.5,Math.floor(g.cpY2)+0.5,Math.floor(g.x)+0.5,Math.floor(g.y)+0.5,this,function(a,b,c,d,f,g){e+="C"+a+" "+b+" "+c+" "+d+" "+f+" "+g})}d.setAttribute("d",e);f=this.m_cache.get(c.name,c.activeLayer.name,"path");null===f?(f=jQuery(d.create()),
d=this._getCanvas(),d.append(f),this.m_cache.put(c.name,c.activeLayer.name,"path",f)):d.update(f[0])};
primitives.common.VmlGraphics=function(a){var b,c,d;this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.prefix="rvml";this.ie8mode=document.documentMode&&8<=document.documentMode;try{eval("document.namespaces")}catch(e){}document.namespaces[this.prefix]||document.namespaces.add(this.prefix,"urn:schemas-microsoft-com:vml");if(!primitives.common.VmlGraphics.prototype.vmlStyle){b=primitives.common.VmlGraphics.prototype.vmlStyle=document.createStyleSheet();
c=[" *","fill","shape","path","textpath"];for(d=0;d<c.length;d+=1)b.addRule(this.prefix+"\\:"+c[d],"behavior:url(#default#VML); position:absolute;")}this.graphicsType=2;this.hasGraphics=!0};primitives.common.VmlGraphics.prototype=new primitives.common.Graphics;
primitives.common.VmlGraphics.prototype.text=function(a,b,c,d,e,f,g,h,j){var m,k,l,i,n,p,v,q,r,s,t,u;0===f?this.parent.text.call(this,a,b,c,d,e,f,g,h,j):(m=this.m_activePlaceholder,m.transformRect(a,b,c,d,this,function(a,b,c,d){k=1===f;l=new primitives.common.Rect(a,b,c,d);i=new primitives.common.Rect(0,0,10*c,10*d);n=new primitives.common.Element(this.prefix+":shape");n.setAttribute("CoordSize",i.width+","+i.height);n.setAttribute("filled",!0);n.setAttribute("stroked",!1);n.setAttribute("fillcolor",
j["font-color"]);n.style.top=l.y+"px";n.style.left=l.x+"px";n.style.width=l.width+"px";n.style.height=l.height+"px";n.style["font-family"]=j["font-family"];p=new primitives.common.Element(this.prefix+":path");p.setAttribute("TextPathOk",!0);v=16*Math.floor(this.getPxSize(j["font-size"]));q=v*Math.max(e.split("\n").length-1,1);s=r=null;if(k)switch(h){case 0:r=new primitives.common.Point(i.x+q/2,i.bottom());s=new primitives.common.Point(i.x+q/2,i.y);break;case 1:r=new primitives.common.Point(i.horizontalCenter(),
i.bottom());s=new primitives.common.Point(i.horizontalCenter(),i.y);break;case 2:r=new primitives.common.Point(i.right()-q/2,i.bottom()),s=new primitives.common.Point(i.right()-q/2,i.y)}else switch(h){case 0:r=new primitives.common.Point(i.right()-q/2,i.y);s=new primitives.common.Point(i.right()-q/2,i.bottom());break;case 1:r=new primitives.common.Point(i.horizontalCenter(),i.y);s=new primitives.common.Point(i.horizontalCenter(),i.bottom());break;case 2:r=new primitives.common.Point(i.x+q/2,i.y),
s=new primitives.common.Point(i.x+q/2,i.bottom())}p.setAttribute("v"," m"+r.x+","+r.y+" l"+s.x+","+s.y+" e");t=new primitives.common.Element(this.prefix+":textpath");t.setAttribute("on",!0);t.setAttribute("string",e);t.style.trim=!1;t.style["v-text-align"]=this._getTextAlign(g);t.style.font="normal normal normal "+j["font-size"]+"pt "+j["font-family"];n.appendChild(p);n.appendChild(t);u=this.m_cache.get(m.name,m.activeLayer.name,"vmltext");null===u?(u=jQuery(n.create(this.ie8mode)),m.activeLayer.canvas.append(u),
this.m_cache.put(m.name,m.activeLayer.name,"vmltext",u)):n.update(u[0],this.ie8mode)}))};
primitives.common.VmlGraphics.prototype.polyline=function(a,b){var c=this.m_activePlaceholder,d=new primitives.common.Rect(c.rect),e=new primitives.common.Rect(0,0,10*d.width,10*d.height),f=new primitives.common.Element(this.prefix+":shape"),g;void 0!==b.borderColor&&void 0!==b.lineWidth?(f.setAttribute("strokecolor",b.borderColor),f.setAttribute("strokeweight",b.lineWidth),f.setAttribute("stroked",!0)):f.setAttribute("stroked",!1);f.setAttribute("CoordSize",e.width+","+e.height);f.style.top=d.y+
"px";f.style.left=d.x+"px";f.style.width=d.width+"px";f.style.height=d.height+"px";g="";for(e=0;e<a.length;e+=1)switch(d=a[e],d.segmentType){case 1:c.transformPoint(Math.floor(d.x),Math.floor(d.y),this,function(a,b){g+=" m"+10*a+","+10*b});break;case 0:c.transformPoint(Math.floor(d.x),Math.floor(d.y),this,function(a,b){g+=" l"+10*a+","+10*b});break;case 4:c.transformPoints(Math.floor(d.x-d.radius),Math.floor(d.y-d.radius),Math.floor(d.x+d.radius),Math.floor(d.y+d.radius),this,function(a,b,c,d){var e;
a>c&&(e=a,a=c,c=e);b>d&&(e=b,b=d,d=e);a=10*a+5;b=10*b+5;c=10*c-5;d=10*d-5;g+=" m"+a+","+b;g+=" l"+c+","+b;g+=" l"+c+","+d;g+=" l"+a+","+d;g+=" l"+a+","+b});break;case 2:c.transformPoints(Math.floor(d.cpX),Math.floor(d.cpY),Math.floor(d.x),Math.floor(d.y),this,function(a,b,c,d){g+=" qb"+10*a+","+10*b+" l"+10*c+","+10*d});break;case 3:c.transform3Points(Math.floor(d.cpX1),Math.floor(d.cpY1),Math.floor(d.cpX2),Math.floor(d.cpY2),Math.floor(d.x),Math.floor(d.y),this,function(a,b,c,d,e,f){g+=" c"+10*a+
","+10*b+","+10*c+","+10*d+","+10*e+","+10*f})}g+=" e";d=new primitives.common.Element(this.prefix+":path");d.setAttribute("v",g);f.appendChild(d);null!==b.fillColor?(f.setAttribute("filled",!0),d=new primitives.common.Element(this.prefix+":fill"),d.setAttribute("opacity",b.opacity),d.setAttribute("color",b.fillColor),f.appendChild(d)):f.setAttribute("filled",!1);d=this.m_cache.get(c.name,c.activeLayer.name,"shapepath");null===d?(d=jQuery(f.create(this.ie8mode)),c.activeLayer.canvas.append(d),this.m_cache.put(c.name,
c.activeLayer.name,"shapepath",d)):f.update(d[0],this.ie8mode)};primitives.text.Config=function(){this.classPrefix="bptext";this.graphicsType=0;this.actualGraphicsType=null;this.orientation=0;this.text="";this.verticalAlignment=1;this.horizontalAlignment=0;this.fontSize="16px";this.fontFamily="Arial";this.color="#000000";this.fontStyle=this.fontWeight="normal"};
primitives.text.Controller=function(){this.widgetEventPrefix="bptext";this.options=new primitives.text.Config;this.m_graphics=this.m_placeholder=null};primitives.text.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.text.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.text.Controller.prototype._createLayout=function(){var a=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(a.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,
this);this.options.actualGraphicsType=this.m_graphics.graphicsType};primitives.text.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.text.Controller.prototype._updateLayout=function(){var a=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(a.getCSS())};
primitives.text.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize(),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.text.Controller.prototype._redraw=function(){var a=this.m_graphics.activate("placeholder");this.m_graphics.text(a.rect.x,a.rect.y,a.rect.width,a.rect.height,this.options.text,this.options.orientation,this.options.horizontalAlignment,this.options.verticalAlignment,{"font-size":this.options.fontSize,"font-family":this.options.fontFamily,"font-style":this.options.fontStyle,"font-weight":this.options.fontWeight,"font-color":this.options.color})};
primitives.text.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};(function(a){a.widget("ui.bpText",new primitives.text.Controller)})(jQuery);
primitives.callout.Config=function(){this.classPrefix="bpcallout";this.graphicsType=1;this.actualGraphicsType=null;this.pointerPlacement=0;this.snapPoint=this.position=null;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.pointerWidth="10%";this.borderColor="#000000";this.fillColor="#d3d3d3"};primitives.callout.Controller=function(){this.widgetEventPrefix="bpcallout";this.options=new primitives.callout.Config;this.m_shape=this.m_graphics=this.m_placeholder=null};
primitives.callout.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.callout.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.callout.Controller.prototype._createLayout=function(){var a=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(a.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,
this);this.options.actualGraphicsType=this.m_graphics.graphicsType;this.m_shape=new primitives.common.Callout(this.m_graphics)};primitives.callout.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.callout.Controller.prototype._updateLayout=function(){var a=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(a.getCSS())};
primitives.callout.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize(),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.callout.Controller.prototype._redraw=function(){this.m_graphics.activate("placeholder");var a="pointerPlacement cornerRadius offset opacity lineWidth pointerWidth borderColor fillColor".split(" "),b,c;for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.draw(this.options.snapPoint,this.options.position)};
primitives.callout.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};(function(a){a.widget("ui.bpCallout",new primitives.callout.Controller)})(jQuery);
primitives.orgdiagram.TemplateConfig=function(){this.name=null;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.highlightPadding=new primitives.common.Thickness(2,2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.cursorTemplate=null};
primitives.orgdiagram.ButtonConfig=function(a,b){this.name=a;this.icon=b;this.text=!1;this.label=null;this.size=new primitives.common.Size(16,16)};
primitives.orgdiagram.Config=function(a){this.name=void 0!==a?a:"OrgDiagram";this.classPrefix="orgdiagram";this.graphicsType=0;this.actualGraphicsType=null;this.pageFitMode=3;this.orientationType=primitives.orgdiagram.OrientationType.Top;this.verticalAlignment=1;this.horizontalAlignment=0;this.connectorType=1;this.emptyDiagramMessage="Diagram is empty.";this.cursorItem=this.highligtItem=this.rootItem=null;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectionPathMode=1;this.minimalVisibility=
2;this.templates=[];this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.itemTitleFirstFontColor="#ffffff";
this.itemTitleSecondFontColor="#000080";this.selectCheckBoxLabel="Selected";this.linesColor="#c0c0c0";this.linesWidth=1;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.leavesPlacementType=this.childrenPlacementType=2;this.maximumColumnsInMatrix=6;this.buttonsPanelSize=28;this.checkBoxPanelSize=this.groupTitlePanelSize=24};
primitives.orgdiagram.ItemConfig=function(a,b,c){this.image=this.description=this.title=null;this.itemTitleColor="#4169e1";this.groupTitle=null;this.groupTitleColor="#4169e1";this.isVisible=!0;this.childrenPlacementType=this.adviserPlacementType=this.itemType=this.hasButtons=this.hasSelectorCheckbox=0;this.items=[];this.templateName=null;switch(arguments.length){case 3:this.title=a,this.description=b,this.image=c}};
primitives.orgdiagram.Controller=function(){this.widgetEventPrefix="orgdiagram";this.options=new primitives.orgdiagram.Config;this.graphics=null;this._treeItems={};this._treeItemCounter=0;this._treeLevels=[];this._leftMargins={};this._rightMargins={};this._templates={};this._groupTitleTemplateHashCode=this._groupTitleTemplate=this._buttonsTemplateHashCode=this._buttonsTemplate=this._checkBoxTemplateHashCode=this._checkBoxTemplate=this._defaultTemplate=null;this._selectedTreeItems=[];this.m_calloutShape=
this.m_calloutPlaceholder=this.m_placeholder=this.m_scrollPanel=this._highlightTreeItem=this._cursorTreeItem=null;this.boxModel=jQuery.support.boxModel};primitives.orgdiagram.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._bind();this.graphics=null;this._redraw()};primitives.orgdiagram.Controller.prototype.destroy=function(){this._unbind();this._clean();this._cleanLayout()};
primitives.orgdiagram.Controller.prototype._clean=function(){null!==this.graphics&&this.graphics.clean();this.graphics=null};primitives.orgdiagram.Controller.prototype._cleanLayout=function(){this.element.find("."+this.widgetEventPrefix).remove()};
primitives.orgdiagram.Controller.prototype._createLayout=function(){var a=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_scrollPanel=jQuery("<div></div>");this.m_scrollPanel.css({position:"relative",overflow:"auto",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_scrollPanel.addClass(this.widgetEventPrefix);this.m_scrollPanel.css(a.getCSS());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"absolute",overflow:"hidden"});
this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.m_placeholder.css(a.getCSS());this.m_scrollPanel.append(this.m_placeholder);this.m_calloutPlaceholder=jQuery("<div></div>");this.m_calloutPlaceholder.css({position:"absolute",overflow:"visible"});this.m_calloutPlaceholder.addClass("calloutplaceholder");this.m_calloutPlaceholder.addClass(this.widgetEventPrefix);this.m_calloutPlaceholder.css({top:"0px",left:"0px",width:"0px",height:"0px"});this.m_placeholder.append(this.m_calloutPlaceholder);
this.element.append(this.m_scrollPanel)};primitives.orgdiagram.Controller.prototype._updateLayout=function(){var a=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_scrollPanel.css(a.getCSS())};
primitives.orgdiagram.Controller.prototype._bind=function(){var a=this;this.m_placeholder.mousemove(function(b){a._onMouseMove(b)}).mouseleave(function(b){a._onMouseMove(b)}).click(function(b){a._onMouseClick(b)});this.options.onDefaultTemplateRender=function(b,c){a._onDefaultTemplateRender(b,c)};this.options.onCheckBoxTemplateRender=function(b,c){a._onCheckBoxTemplateRender(b,c)};this.options.onGroupTitleTemplateRender=function(b,c){a._onGroupTitleTemplateRender(b,c)};this.options.onButtonsTemplateRender=
function(b,c){a._onButtonsTemplateRender(b,c)}};primitives.orgdiagram.Controller.prototype._unbind=function(){this.m_placeholder.unbind("mousemove");this.m_placeholder.unbind("mouseleave");this.m_placeholder.unbind("click");this.options.onDefaultTemplateRender=null;this.options.onCheckBoxTemplateRender=null};primitives.orgdiagram.Controller.prototype.update=function(a){switch(a){case 2:this._redrawHighlight();break;case 1:this._refresh();break;default:this._redraw()}};
primitives.orgdiagram.Controller.prototype._onMouseMove=function(a){var b=this.m_placeholder.offset(),c=b.left,d=b.top,e=this._getTreeItemForMousePosition(a.pageX-c,a.pageY-d),f;"ontouchstart"in document.documentElement?this._highlightTreeItem=e:null!==e?e.itemConfig!==this.options.highlightItem&&(this._highlightTreeItem=e,f=new primitives.orgdiagram.EventArgs,f.oldContext=this.options.highlightItem,this.options.highlightItem=e.itemConfig,f.context=this.options.highlightItem,f.parentItem=null!==this._highlightTreeItem.logicalParentId?
this._treeItems[this._highlightTreeItem.logicalParentId].itemConfig:null,b=this.element.offset(),f.position=(new primitives.common.Rect(e.actualPosition)).translate(c,d).translate(-b.left,-b.top),this._trigger("onHighlightChanging",a,f),f.cancel||(this._refreshHighlight(),this._trigger("onHighlightChanged",a,f))):null!==this.options.highlightItem&&(this._highlightTreeItem=null,f=new primitives.orgdiagram.EventArgs,f.oldContext=this.options.highlightItem,f.parentItem=null,this.options.highlightItem=
null,f.context=this.options.highlightItem,this._trigger("onHighlightChanging",a,f),f.cancel||(this._refreshHighlight(),this._trigger("onHighlightChanged",a,f)))};
primitives.orgdiagram.Controller.prototype._onMouseClick=function(a){var b=this._highlightTreeItem,c,d;null!==b&&(c=jQuery(a.target),c.hasClass(this.widgetEventPrefix+"button")||0<c.parent("."+this.widgetEventPrefix+"button").length?(c=c.hasClass(this.widgetEventPrefix+"button")?c:c.parent("."+this.widgetEventPrefix+"button"),d=c.data("buttonname"),c=new primitives.orgdiagram.EventArgs,c.context=b.itemConfig,c.parentItem=null!==b.logicalParentId?this._treeItems[b.logicalParentId].itemConfig:null,
c.name=d,this._trigger("onButtonClick",a,c)):"checkbox"===c.attr("name")?(c=new primitives.orgdiagram.EventArgs,c.context=b.itemConfig,c.parentItem=null!==b.logicalParentId?this._treeItems[b.logicalParentId].itemConfig:null,this._trigger("onSelectionChanging",a,c),d=primitives.common.indexOf(this.options.selectedItems,b.itemConfig),0<=d?this.options.selectedItems.splice(d,1):this.options.selectedItems.push(b.itemConfig),this._trigger("onSelectionChanged",a,c)):(c=new primitives.orgdiagram.EventArgs,
c.context=b.itemConfig,c.parentItem=null!==b.logicalParentId?this._treeItems[b.logicalParentId].itemConfig:null,this._trigger("onMouseClick",a,c),!c.cancel&&b.itemConfig!==this.options.cursorItem&&(c=new primitives.orgdiagram.EventArgs,c.oldContext=this.options.cursorItem,this.options.cursorItem=b.itemConfig,c.context=this.options.cursorItem,c.parentItem=null!==b.logicalParentId?this._treeItems[b.logicalParentId].itemConfig:null,this._trigger("onCursorChanging",a,c),c.cancel||(this._refresh(),this._trigger("onCursorChanged",
a,c)))))};primitives.orgdiagram.Controller.prototype._redraw=function(){this._clean();this.graphics=primitives.common.createGraphics(this.options.graphicsType,this);this.options.actualGraphicsType=this.graphics.graphicsType;this.m_calloutShape=new primitives.common.Callout(this.graphics);this._readTemplates();this._createCheckBoxTemplate();this._createButtonsTemplate();this._createGroupTitleTemplate();this._refresh()};
primitives.orgdiagram.Controller.prototype._refresh=function(){this._updateLayout();this._readTreeItems();this._positionTreeItems();this.graphics.resize();this.graphics.begin();this._redrawTreeItems();this._redrawConnectors();this._drawHighlight();this._drawHighlightAnnotation();this._drawCursor();this.graphics.end();this._centerOnCursor()};
primitives.orgdiagram.Controller.prototype._setTransform=function(){switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Top:this.graphics.setTransform("placeholder",!1,!1,!1);break;case primitives.orgdiagram.OrientationType.Bottom:this.graphics.setTransform("placeholder",!1,!1,!0);break;case primitives.orgdiagram.OrientationType.Left:this.graphics.setTransform("placeholder",!0,!1,!1);break;case primitives.orgdiagram.OrientationType.Right:this.graphics.setTransform("placeholder",
!0,!0,!1)}};primitives.orgdiagram.Controller.prototype._redrawHighlight=function(){var a,b;for(a in this._treeItems)this._treeItems.hasOwnProperty(a)&&(b=this._treeItems[a],b.itemConfig===this.options.highlightItem&&(this._highlightTreeItem=b));this._refreshHighlight()};primitives.orgdiagram.Controller.prototype._refreshHighlight=function(){this.graphics.reset("placeholder",2);this.graphics.reset("calloutplaceholder",6);this._drawHighlight();this._drawHighlightAnnotation()};
primitives.orgdiagram.Controller.prototype._drawHighlight=function(){var a,b,c;null!==this._highlightTreeItem&&(this.graphics.activate("placeholder",2),a=this._highlightTreeItem.actualPosition,b=new primitives.common.Rect(0,0,this._highlightTreeItem.actualSize.width,this._highlightTreeItem.actualSize.height),c=this._highlightTreeItem.template.highlightPadding,b.offset(c.left,c.top,c.right,c.bottom),c=new primitives.common.RenderEventArgs,c.context=this._highlightTreeItem.itemConfig,c.isCursor=this._highlightTreeItem.isCursor,
c.isSelected=this._highlightTreeItem.isSelected,c.templateName=this._highlightTreeItem.template.name,this.graphics.template(a.x,a.y,a.width,a.height,b.x,b.y,b.width,b.height,this._highlightTreeItem.template.highlightTemplate,this._highlightTreeItem.template.highlightTemplateHashCode,this._highlightTreeItem.template.highlightTemplateRenderName,c,{"border-width":this._highlightTreeItem.template.highlightBorderWidth}))};
primitives.orgdiagram.Controller.prototype._drawCursor=function(){var a,b,c,d;null!==this._cursorTreeItem&&(this.graphics.activate("placeholder",4),a=this._cursorTreeItem,b=a.actualPosition,c=new primitives.common.Rect(a.contentPosition),d=a.template.cursorPadding,c.offset(d.left,d.top,d.right,d.bottom),d=new primitives.common.RenderEventArgs,d.context=a.itemConfig,d.isCursor=a.isCursor,d.isSelected=a.isSelected,d.templateName=a.template.name,this.graphics.template(b.x,b.y,b.width,b.height,c.x,c.y,
c.width,c.height,a.template.cursorTemplate,a.template.cursorTemplateHashCode,a.template.cursorTemplateRenderName,d,{"border-width":a.template.cursorBorderWidth}))};
primitives.orgdiagram.Controller.prototype._redrawTreeItems=function(){var a,b,c,d,e={};this.graphics.activate("placeholder",5);this._setTransform();for(d in this._treeItems)if(this._treeItems.hasOwnProperty(d))switch(a=this._treeItems[d],b=this._treeLevels[a.level],a.setActualPosition(b,this.options),a.actualVisibility){case 1:b=new primitives.common.RenderEventArgs;b.context=a.itemConfig;b.isCursor=a.isCursor;b.isSelected=a.isSelected;b.templateName=a.template.name;this.graphics.template(a.actualPosition.x,
a.actualPosition.y,a.actualPosition.width,a.actualPosition.height,a.contentPosition.x,a.contentPosition.y,a.contentPosition.width,a.contentPosition.height,a.template.itemTemplate,a.template.itemTemplateHashCode,a.template.itemTemplateRenderName,b,{"border-width":a.template.itemBorderWidth});a.hasGroupTitle&&this.graphics.template(a.actualPosition.x,a.actualPosition.y,a.actualPosition.width,a.actualPosition.height,2,a.contentPosition.y,this.options.groupTitlePanelSize-4,a.contentPosition.height,this._groupTitleTemplate,
this._groupTitleTemplateHashCode,"onGroupTitleTemplateRender",a,null);a.hasSelectorCheckbox&&this.graphics.template(a.actualPosition.x,a.actualPosition.y,a.actualPosition.width,a.actualPosition.height,a.contentPosition.x,a.actualSize.height-(this.options.checkBoxPanelSize-4),a.contentPosition.width,this.options.checkBoxPanelSize-4,this._checkBoxTemplate,this._checkBoxTemplateHashCode,"onCheckBoxTemplateRender",a,null);a.hasButtons&&this.graphics.template(a.actualPosition.x,a.actualPosition.y,a.actualPosition.width,
a.actualPosition.height,a.actualSize.width-(this.options.buttonsPanelSize-4),a.contentPosition.y,this.options.buttonsPanelSize-4,Math.max(a.contentPosition.height,a.actualSize.height-a.contentPosition.y),this._buttonsTemplate,this._buttonsTemplateHashCode,"onButtonsTemplateRender",a,null);break;case 2:c=a.itemConfig.itemTitleColor,null==c&&(c="#000080"),e.hasOwnProperty(c)||(e[c]=[]),b=e[c],b.push(new primitives.common.DotSegment(a.actualPosition.horizontalCenter(),a.actualPosition.verticalCenter(),
a.actualPosition.width/2))}this.graphics.activate("placeholder",3);for(c in e)e.hasOwnProperty(c)&&(b=e[c],a={fillColor:c,opacity:1},this.graphics.polyline(b,a))};
primitives.orgdiagram.Controller.prototype._redrawConnectors=function(){var a=this.graphics.activate("placeholder",1),b=this._visualRootItem,c,d;this._treeItems.hasOwnProperty(b)&&(c=this._treeItems[b],d=this._treeLevels[c.level],b=[],this._redrawConnector(a.hasGraphics,b,c,d),a={borderColor:this.options.linesColor,lineWidth:this.options.linesWidth},this.graphics.polyline(b,a))};
primitives.orgdiagram.Controller.prototype._redrawConnector=function(a,b,c,d){var e,f,g,h,j,m,k,l,i,n,p;if(0<c.visualChildren.length){e=4===c.actualVisibility&&c.id===this._visualRootItem;e||(f=new primitives.common.Point(c.actualPosition.horizontalCenter(),c.actualPosition.bottom()),g=new primitives.common.Point(c.actualPosition.horizontalCenter(),d.connectorShift),b.push(new primitives.common.MoveSegment(f)),b.push(new primitives.common.LineSegment(g)));j=h=null;m=[];k=c.visualChildren;for(n=0;n<
k.length;n+=1){l=this._treeItems[k[n]];i=this._treeLevels[l.level];switch(l.connectorPlacement){case 7:f=new primitives.common.Point(l.actualPosition.x,l.actualPosition.verticalCenter());g=this._treeItems[i.treeItems[l.levelPosition-1]];g=new primitives.common.Point(g.actualPosition.right(),l.actualPosition.verticalCenter());b.push(new primitives.common.MoveSegment(f));b.push(new primitives.common.LineSegment(g));break;case 3:f=new primitives.common.Point(l.actualPosition.right(),l.actualPosition.verticalCenter());
g=this._treeItems[i.treeItems[l.levelPosition+1]];g=new primitives.common.Point(g.actualPosition.x,l.actualPosition.verticalCenter());b.push(new primitives.common.MoveSegment(f));b.push(new primitives.common.LineSegment(g));break;case 1:if(!e)switch(f=new primitives.common.Point(l.actualPosition.horizontalCenter(),d.connectorShift),g=new primitives.common.Point(l.actualPosition.horizontalCenter(),l.actualPosition.top()),p=a?l.actualVisibility:1,p){case 1:case 4:0<m.length&&(p=this._drawAngularConnectors(b,
null,d.connectorShift,m),null===h&&(h=p));b.push(new primitives.common.MoveSegment(f));b.push(new primitives.common.LineSegment(g));null===h?h=f:j=f;break;case 2:case 3:switch(this.options.connectorType){case 1:case 2:m.push(g);break;case 0:b.push(new primitives.common.MoveSegment(f)),b.push(new primitives.common.LineSegment(g)),null===h?h=f:j=f}}}this._redrawConnector(a,b,l,i)}e||(0<m.length&&(j=this._drawAngularConnectors(b,k.length===m.length?c.actualPosition.horizontalCenter():null,d.connectorShift,
m)),null!==h&&null!==j&&(a=c.actualPosition.horizontalCenter(),a<h.x?h.x=a:a>j.x&&(j.x=a),h!==j&&(b.push(new primitives.common.MoveSegment(h)),b.push(new primitives.common.LineSegment(j)))))}};
primitives.orgdiagram.Controller.prototype._drawAngularConnectors=function(a,b,c,d){var e=null;if(0<d.length){e=new primitives.common.Point(null!==b?b:(d[0].x+d[d.length-1].x)/2,c);for(b=0;b<d.length;b+=1)switch(a.push(new primitives.common.MoveSegment(e)),this.options.connectorType){case 1:a.push(new primitives.common.LineSegment(d[b]));break;case 2:c=new primitives.common.Rect(e,d[b]),e.x>c.x?a.push(new primitives.common.CubicArcSegment(c.right(),c.verticalCenter(),c.x,c.verticalCenter(),c.x,c.bottom())):
a.push(new primitives.common.CubicArcSegment(c.x,c.verticalCenter(),c.right(),c.verticalCenter(),c.right(),c.bottom()))}}d.length=0;return e};
primitives.orgdiagram.Controller.prototype._centerOnCursor=function(){var a,b;null!==this._cursorTreeItem&&(a=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight()),b=this.graphics.activate("placeholder",5),b.transformPoint(this._cursorTreeItem.actualPosition.horizontalCenter(),this._cursorTreeItem.actualPosition.verticalCenter(),this,function(b,d){this.m_scrollPanel.scrollLeft(b-a.horizontalCenter());this.m_scrollPanel.scrollTop(d-a.verticalCenter())}))};
primitives.orgdiagram.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};
primitives.orgdiagram.Controller.prototype._getTreeItemForMousePosition=function(a,b){var c=null,d,e,f,g,h,j,m,k,l;this.graphics.activate("placeholder",5).transformPointBack(a,b,this,function(a,b){d=0;for(e=this._treeLevels.length;d<e;d+=1)if(g=this._treeLevels[d],b>g.topConnectorShift&&b<=g.connectorShift){j=h=null;k=0;for(f=g.treeItems.length;k<f;k+=1)switch(m=this._treeItems[g.treeItems[k]],m.actualVisibility){case 1:if(m.actualPosition.contains(a,b)){c=m;return}case 2:case 3:if(l=Math.abs(m.actualPosition.horizontalCenter()-
a),null===j||l<j)j=l,h=m}c=h;break}});return c};
primitives.orgdiagram.Controller.prototype._drawHighlightAnnotation=function(){var a=primitives.common,b,c,d,e,f,g,h,j;if(null!==this._highlightTreeItem)switch(this._highlightTreeItem.actualVisibility){case 2:case 3:c=this._highlightTreeItem;d=new a.Rect(this.m_scrollPanel.scrollLeft(),this.m_scrollPanel.scrollTop(),Math.min(this.m_scrollPanel.innerWidth()-25,this.m_placeholder.innerWidth()),Math.min(this.m_scrollPanel.innerHeight()-25,this.m_placeholder.innerHeight()));b=this.graphics.activate("placeholder",
5);b.transformPoint(c.actualPosition.horizontalCenter(),c.actualPosition.verticalCenter(),this,function(m,k){f=new a.Point(m,k);g=this._getAnnotationPosition(f,d,c.template.itemSize);e=new a.Rect(g);e.addRect(f.x,f.y);e.offset(50);j=e.getCSS();j.display="inherit";j.visibility="inherit";this.m_calloutPlaceholder.css(j);f.x-=e.x;f.y-=e.y;g.x-=e.x;g.y-=e.y;h=new a.RenderEventArgs;h.context=c.itemConfig;h.isCursor=c.isCursor;h.isSelected=c.isSelected;h.templateName=c.template.name;this.graphics.resize("calloutplaceholder");
b=this.graphics.activate("calloutplaceholder",6);this.graphics.template(g.x,g.y,g.width,g.height,0,0,g.width,g.height,c.template.itemTemplate,c.template.itemTemplateHashCode,c.template.itemTemplateRenderName,h,null);this.pointerPlacement=0;this.m_calloutShape.cornerRadius=this.options.calloutCornerRadius;this.m_calloutShape.offset=this.options.calloutOffset;this.m_calloutShape.opacity=this.options.calloutOpacity;this.m_calloutShape.lineWidth=this.options.calloutLineWidth;this.m_calloutShape.pointerWidth=
this.options.calloutPointerWidth;this.m_calloutShape.borderColor=this.options.calloutBorderColor;this.m_calloutShape.fillColor=this.options.calloutfillColor;this.m_calloutShape.draw(f,g)});break;case 1:case 4:this.m_calloutPlaceholder.css({display:"none",visibility:"hidden"})}};
primitives.orgdiagram.Controller.prototype._getAnnotationPosition=function(a,b,c){var d=new primitives.common.Rect(a.x,a.y,c.width,c.height);a.y>b.bottom()-b.height/4?(d.y-=c.height/2,d.x=a.x<b.horizontalCenter()?d.x+c.width/4:d.x-(c.width/4+c.width)):(d.y+=c.height/4,d.x-=c.width/2);d.x<b.x?d.x=b.x+5:d.right()>b.right()&&(d.x-=d.right()-b.right()+5);d.y<b.y?d.y=b.y+5:d.bottom()>b.bottom()&&(d.y-=d.bottom()-b.bottom()+5);return d};
primitives.orgdiagram.Controller.prototype._positionTreeItems=function(){var a=new primitives.common.Rect(0,0,this.element.outerWidth()-25,this.element.outerHeight()-25),b=new primitives.common.Rect(0,0,0,0),c,d,e,f,g;switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:a.invert()}if(0<this._treeLevels.length){switch(this.options.pageFitMode){case 0:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,
0);break;default:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=[];switch(this.options.minimalVisibility){case 2:b.push(2);break;case 0:case 3:case 4:b.push(2),b.push(3)}for(d=this._treeLevels.length-1;0<=d;d-=1)for(e=0;e<b.length;e+=1)c.push(new primitives.orgdiagram.LevelVisibility(d,b[e]));d=this._setTreeLevelsVisibilityAndPositionTreeItems(c,c.length-1);d.addRect(a);d.offset(0,0,5,5);b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,0);if(!this._checkDiagramSize(b,d)&&(e=0,b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,
c.length-1),this._checkDiagramSize(b,d))){for(g=f=c.length-1;1<f-e;)g=Math.floor((f+e)/2),b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,g),this._checkDiagramSize(b,d)?f=g:e=g;f!==g&&(b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,f))}}b.width<a.width&&(this._stretchToWidth(b.width,a.width),b.width=a.width);b.height<a.height&&(b.height=a.height);switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:b.invert()}this.m_placeholder.css(b.getCSS())}};
primitives.orgdiagram.Controller.prototype._checkDiagramSize=function(a,b){var c=!1;switch(this.options.pageFitMode){case 1:b.width>=a.width&&(c=!0);break;case 2:b.height>=a.height&&(c=!0);break;case 3:b.height>=a.height&&b.width>=a.width&&(c=!0)}return c};
primitives.orgdiagram.Controller.prototype._setTreeLevelsVisibilityAndPositionTreeItems=function(a,b){var c,d;for(c=0;c<this._treeLevels.length;c+=1)this._treeLevels[c].currentvisibility=1;for(c=0;c<=b;c+=1)d=a[c],this._treeLevels[d.level].currentvisibility=d.currentvisibility;this._recalcLevelsDepth();this._shiftLevels();this._setOffsets();return new primitives.common.Rect(0,0,this._getDiagramWidth(),this._getDiagramHeight())};
primitives.orgdiagram.Controller.prototype._getDiagramHeight=function(){return this._treeLevels[this._treeLevels.length-1].connectorShift};primitives.orgdiagram.Controller.prototype._getDiagramWidth=function(){var a=0,b,c;b=0;for(c=this._treeLevels.length;b<c;b+=1)a=Math.max(a,this._treeLevels[b].currentOffset);return a+=this.options.normalItemsInterval};
primitives.orgdiagram.Controller.prototype._setOffsets=function(){var a,b;a=0;for(b=this._treeLevels.length;a<b;a+=1)this._treeLevels[a].currentOffset=0;void 0!==this._treeItems[this._visualRootItem]&&this._setOffset(this._treeItems[this._visualRootItem])};
primitives.orgdiagram.Controller.prototype._setOffset=function(a){var b=this._treeLevels[a.level],c=this._getItemsInterval(0===a.visibility?b.currentvisibility:a.visibility)/2,d,e,f,g,h,j;a.offset=b.currentOffset+c;a.padding=c;b.currentOffset=a.offset+a.actualSize.width+c;if(0<a.visualChildren.length){b=0;for(d=a.visualChildren.length;b<d;b+=1)this._setOffset(this._treeItems[a.visualChildren[b]]);c=this._getChildrenOffset(a);if(0<c)this._offsetItemChildren(a,c);else if(0>c&&(c=-c,this._offsetItem(a,
c),d=null,e={},g=null,h=this._getParentItem(a),null!==h)){for(b=h.visualChildren.length-1;0<=b;b-=1)if(j=h.visualChildren[b],j===a)d=[];else if(null!==d)if(f=this._getGapBetweenSiblings(j,a),e[j.id]=f,0<f)d.splice(0,0,j);else{g=j;break}if(0<d.length){if(null!==g){f=[g];f=f.concat(d);f.push(a);g=[[g]];b=1;for(d=f.length;b<d;b+=1)a=f[b-1],h=f[b],3===a.connectorPlacement||7===h.connectorPlacement?g[g.length-1].push(h):g.push([h])}else g=[d.slice(0)],g[g.length-1].push(a);if(0<g.length){d=g[g.length-
1];for(b=d.length-2;0<=b;b-=1)a=d[b],f=e[a.id],c=Math.min(f,c),this._offsetItem(a,c),this._offsetItemChildren(a,c)}h=c/(g.length-1);for(d=g.length-2;0<d;d-=1){j=g[d];for(b=j.length-1;0<=b;b-=1)a=j[b],f=e[a.id],c=Math.min(d*h,Math.min(f,c)),this._offsetItem(a,c),this._offsetItemChildren(a,c)}}}}};
primitives.orgdiagram.Controller.prototype._getGapBetweenSiblings=function(a,b){var c=null,d=this._getRightMargins(a),e=this._getLeftMargins(b),f=Math.min(d.length,e.length),g,h;for(g=0;g<f&&!(h=e[g]-d[g],c=null!==c?Math.min(c,h):h,0>=h);g+=1);return Math.floor(c)};
primitives.orgdiagram.Controller.prototype._getRightMargins=function(a){var b=[],c,d,e;c=this._rightMargins[a];void 0===c&&(c=[]);c=c.slice();c.splice(0,0,a.id);a=0;for(d=c.length;a<d;a+=1)e=this._treeItems[c[a]],b[a]=e.offset+e.actualSize.width+e.padding;return b};
primitives.orgdiagram.Controller.prototype._getLeftMargins=function(a){var b=[],c,d,e;c=this._leftMargins[a];void 0===c&&(c=[]);c=c.slice();c.splice(0,0,a.id);a=0;for(d=c.length;a<d;a+=1)e=this._treeItems[c[a]],b[a]=e.offset-e.padding;return b};
primitives.orgdiagram.Controller.prototype._getChildrenOffset=function(a){var b=a.offset+a.actualSize.width/2,c=null,d,e,f;if(null===a.visualAggregatorId){a=a.visualChildren;d=null;f=0;for(e=a.length;f<e&&!(d=this._treeItems[a[f]],1===d.connectorPlacement);f+=1);e=null;for(f=a.length-1;0<=f&&!(e=this._treeItems[a[f]],1===e.connectorPlacement);f-=1);switch(this.options.horizontalAlignment){case 1:c=d.offset+d.actualSize.width/2;break;case 2:c=e.offset+e.actualSize.width/2;break;case 0:c=(d.offset+
e.offset+e.actualSize.width)/2}}else c=this._treeItems[a.visualAggregatorId],c=c.offset+c.actualSize.width/2;return b-c};primitives.orgdiagram.Controller.prototype._getParentItem=function(a){var b=null;null!==a&&null!==a.visualParentId&&(b=this._treeItems[a.visualParentId]);return b};primitives.orgdiagram.Controller.prototype._offsetItem=function(a,b){a.offset+=b;var c=this._treeLevels[a.level];c.currentOffset=Math.max(c.currentOffset,a.offset+a.actualSize.width)};
primitives.orgdiagram.Controller.prototype._offsetItemChildren=function(a,b){var c=a.visualChildren,d,e,f;if(0<c.length){d=null;e=0;for(f=c.length;e<f;e+=1)d=this._treeItems[c[e]],d.offset+=b,this._offsetItemChildren(d,b);c=this._treeLevels[d.level];c.currentOffset=Math.max(c.currentOffset,d.offset+d.actualSize.width)}};
primitives.orgdiagram.Controller.prototype._getItemsInterval=function(a){var b=0;switch(a){case 1:b=this.options.normalItemsInterval;break;case 2:b=this.options.dotItemsInterval;break;case 3:case 4:b=this.options.lineItemsInterval}return b};
primitives.orgdiagram.Controller.prototype._stretchToWidth=function(a,b){var c,d;switch(this.options.horizontalAlignment){case 1:c=0;break;case 2:c=b-a;break;case 0:c=(b-a)/2}if(0<c)for(d in this._treeItems)this._treeItems.hasOwnProperty(d)&&(this._treeItems[d].offset+=c)};
primitives.orgdiagram.Controller.prototype._recalcLevelsDepth=function(){var a,b,c,d;a=0;for(b=this._treeLevels.length;a<b;a+=1)c=this._treeLevels[a],c.shift=0,c.depth=0,c.actualVisibility=4;for(d in this._treeItems)this._treeItems.hasOwnProperty(d)&&(a=this._treeItems[d],c=this._treeLevels[a.level],a.setActualSize(c,this.options),c.depth=Math.max(c.depth,a.actualSize.height),c.actualVisibility=Math.min(c.actualVisibility,a.actualVisibility))};
primitives.orgdiagram.Controller.prototype._shiftLevels=function(){var a=this.options.lineLevelShift,b,c,d,e;b=0;for(c=this._treeLevels.length;b<c;b+=1)d=this._treeLevels[b],d.shift=a,e=this._getLevelShift(d.actualVisibility),d.connectorShift=d.shift+d.depth+e/2,d.topConnectorShift=d.shift-e/2,a+=d.depth+e};primitives.orgdiagram.Controller.prototype._getLevelShift=function(a){var b=0;switch(a){case 1:b=this.options.normalLevelShift;break;case 2:b=this.options.dotLevelShift;break;case 3:case 4:b=this.options.lineLevelShift}return b};
primitives.orgdiagram.Controller.prototype._readTemplates=function(){var a,b;this._templates={};a=new primitives.orgdiagram.Template(new primitives.orgdiagram.TemplateConfig);a.name=this.widgetEventPrefix+"Template";a.createDefaultTemplates(this.options);this._templates[a.name]=a;for(a=0;a<this.options.templates.length;a+=1)b=this.options.templates[a],b=new primitives.orgdiagram.Template(b),b.createDefaultTemplates(this.options),this._templates[b.name]=b};
primitives.orgdiagram.Controller.prototype._onDefaultTemplateRender=function(a,b){var c=b.context,d=primitives.common.highestContrast(c.itemTitleColor,this.options.itemTitleSecondFontColor,this.options.itemTitleFirstFontColor);b.element.find("[name=titleBackground]").css({background:c.itemTitleColor});b.element.find("[name=photo]").attr({src:c.image,alt:c.title});b.element.find("[name=title]").css({color:d}).text(c.title);b.element.find("[name=description]").text(c.description)};
primitives.orgdiagram.Controller.prototype._createCheckBoxTemplate=function(){var a=jQuery("<div></div>");a.addClass("bp-item bp-selectioncheckbox-frame");a.append(jQuery('<nobr><input type="checkbox" name="checkbox" class="bp-selectioncheckbox" />&nbsp;<span class="bp-selectiontext">'+this.options.selectCheckBoxLabel+"</span></nobr>"));this._checkBoxTemplate=a.wrap("<div>").parent().html();this._checkBoxTemplateHashCode=primitives.common.hashCode(this._checkBoxTemplate)};
primitives.orgdiagram.Controller.prototype._onCheckBoxTemplateRender=function(a,b){var c=b.element.find("[name=checkbox]");b.isSelected?c.attr("checked","checked"):c.removeAttr("checked")};primitives.orgdiagram.Controller.prototype._createGroupTitleTemplate=function(){var a=jQuery("<div></div>");a.addClass("bp-item bp-corner-all bp-grouptitle-frame");this._groupTitleTemplate=a.wrap("<div>").parent().html();this._groupTitleTemplateHashCode=primitives.common.hashCode(this._groupTitleTemplate)};
primitives.orgdiagram.Controller.prototype._onGroupTitleTemplateRender=function(a,b){var c=new primitives.text.Config;c.orientation=2;c.horizontalAlignment=0;c.verticalAlignment=1;c.text=b.itemConfig.groupTitle;c.fontSize="12px";c.color=primitives.common.highestContrast(b.itemConfig.groupTitleColor,this.options.itemTitleSecondFontColor,this.options.itemTitleFirstFontColor);c.fontFamily="Verdana";switch(b.renderingMode){case 0:b.element.bpText(c);break;case 1:b.element.bpText("option",c),b.element.bpText("update")}primitives.common.css(b.element,
{background:b.itemConfig.groupTitleColor})};primitives.orgdiagram.Controller.prototype._createButtonsTemplate=function(){var a=jQuery("<ul></ul>");a.css({position:"absolute"}).addClass("ui-widget ui-helper-clearfix");this._buttonsTemplate=a.wrap("<div>").parent().html();this._buttonsTemplateHashCode=primitives.common.hashCode(this._buttonsTemplate)};
primitives.orgdiagram.Controller.prototype._onButtonsTemplateRender=function(a,b){var c=0,d,e,f;switch(b.renderingMode){case 0:for(f=0;f<this.options.buttons.length;f+=1)d=this.options.buttons[f],e=jQuery('<li data-buttonname="'+d.name+'"></li>').css({position:"absolute",top:c+"px",left:"0px",width:d.size.width+"px",height:d.size.height+"px",padding:"3px"}).addClass(this.widgetEventPrefix+"button"),b.element.append(e),e.button({icons:{primary:d.icon},text:d.text,label:d.label}),c+=10+d.size.height}};
primitives.orgdiagram.Controller.prototype._readTreeItems=function(){var a;this._highlightTreeItem=this._cursorTreeItem=null;this._selectedTreeItems.length=0;this._defaultTemplate=null;this._defaultTemplate=this._templates[this.options.defaultTemplateName];void 0===this._defaultTemplate&&(this._defaultTemplate=this._templates[this.widgetEventPrefix+"Template"]);this._treeItemCounter=0;this._treeItems={};this._treeLevels=[];this._leftMargins={};this._rightMargins={};this._visualRootItem=0;if(null!==
this.options.rootItem){a=this._getNewTreeItem({itemConfig:this.options.rootItem});switch(a.itemConfig.itemType){case 2:case 5:case 1:case 4:a.actualItemType=0;break;default:a.actualItemType=a.itemConfig.itemType}a.visibility=3===a.actualItemType||!a.itemConfig.isVisible?4:0;this._createVisualTree(a);this._readVisualTree(this._treeItems[this._visualRootItem],0);this._showSelectedItems();this._showCursorNeigbours()}};
primitives.orgdiagram.Controller.prototype._getNewTreeItem=function(a){var b=new primitives.orgdiagram.TreeItem(this._treeItemCounter),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);this._treeItemCounter+=1;return this._treeItems[b.id]=b};
primitives.orgdiagram.Controller.prototype._createVisualTree=function(a){var b,c,d,e,f,g,h,j;g=[];f=a.itemConfig.items.slice(0);h=0;for(e=f.length;h<e;h+=1)if(c=f[h],this._hasVisibleChildren(c))switch(b=this._getNewTreeItem({itemConfig:c,logicalParentId:a.id,visualParentId:a.id,actualItemType:c.itemType}),g.push(b),this._getFirstLogicalVisibleParent(a).logicalChildren.push(b),b.visibility=3===b.actualItemType||!b.itemConfig.isVisible?4:0,b.actualItemType){case 5:b=this._createNewVisualParent(b);case 2:null===
a.visualParentId&&this._createNewVisualRoot(a);d=this._treeItems[a.visualParentId];switch(a.connectorPlacement){case 1:switch(c.adviserPlacementType){case 2:c=this._findLeftSiblingIndex(d.visualChildren,a);d.visualChildren.splice(c+1,0,b);b.connectorPlacement=3;break;default:c=this._findRightSiblingIndex(d.visualChildren,a),d.visualChildren.splice(c,0,b),b.connectorPlacement=7}break;case 3:c=this._findLeftSiblingIndex(d.visualChildren,a);d.visualChildren.splice(c+1,0,b);b.connectorPlacement=3;break;
case 7:c=this._findRightSiblingIndex(d.visualChildren,a),d.visualChildren.splice(c,0,b),b.connectorPlacement=7}b.visualParentId=a.visualParentId;break;case 4:b=this._createNewVisualParent(b);case 1:null===a.visualAggregatorId&&this._createNewVisualAggregator(a);switch(c.adviserPlacementType){case 2:a.visualChildren.splice(0,0,b);b.connectorPlacement=3;break;default:a.visualChildren.push(b),b.connectorPlacement=7}b.visualParentId=a.id;break;case 0:case 3:d=a,null!==a.visualAggregatorId&&(d=this._treeItems[a.visualAggregatorId]),
d.visualChildren.push(b),b.visualParentId=d.id}b=[];d=[];this._layoutChildren(a,b,d);h=0;for(e=g.length;h<e;h+=1)this._createVisualTree(g[h]);if(null!==a.visualAggregatorId&&(e=this._treeItems[a.visualAggregatorId],0<e.visualChildren.length&&(g=this._getAssitantsDepth(a),1<g)))for(h=0;h<g-1;h+=1)e=this._createNewVisualAggregator(e);if(0<a.visualChildren.length&&(g=this._getAdvisersDepth(a),1<g)){e=a;for(h=0;h<g-1;h+=1)e=this._createNewVisualAggregator(e)}c=[];h=0;for(e=d.length;h<e;h+=1){g=d[h];a=
c[h]=0;for(f=g.length;a<f;a+=1)c[h]=Math.max(c[h],this._getItemDepth(g[a]))}h=0;for(e=c.length;h<e;h+=1)if(d=c[h],1<d){a=0;for(f=b[h].length;a<f;a+=1)if(j=b[h][a],0<j.visualChildren.length)for(g=d;1<g;)j=this._createNewVisualAggregator(j),g-=1}};primitives.orgdiagram.Controller.prototype._getFirstLogicalVisibleParent=function(a){var b=a;4===a.visibility&&null!=a.logicalParentId&&(b=this._getFirstLogicalVisibleParent(this._treeItems[a.logicalParentId]));return b};
primitives.orgdiagram.Controller.prototype._createNewVisualParent=function(a){var b;b=this._getNewTreeItem({visibility:4,visualChildren:[a]});a.visualParentId=b.id;return b};primitives.orgdiagram.Controller.prototype._hasVisibleChildren=function(a){var b=!0,c,d;if(3===a.itemType||!a.isVisible){b=!1;c=0;for(d=a.items.length;c<d;c+=1)if(this._hasVisibleChildren(a.items[c])){b=!0;break}}return b};
primitives.orgdiagram.Controller.prototype._getAdvisersDepth=function(a){var b=0,c=this._getParentItem(a),d,e;if(null!==c){a=primitives.common.indexOf(c.visualChildren,a);for(d=a+1;d<c.visualChildren.length;d+=1)if(e=c.visualChildren[d],7===e.connectorPlacement)b=Math.max(b,this._getItemDepth(e));else break;for(d=a-1;0<=d;d-=1)if(e=c.visualChildren[d],3===e.connectorPlacement)b=Math.max(b,this._getItemDepth(e));else break}return b};
primitives.orgdiagram.Controller.prototype._getAssitantsDepth=function(a){var b=0,c,d;for(c=0;c<a.visualChildren.length;c+=1)d=a.visualChildren[c],1!==d.connectorPlacement&&(b=Math.max(b,this._getItemDepth(d)));return b};primitives.orgdiagram.Controller.prototype._getItemDepth=function(a){var b=0,c,d;c=0;for(d=a.visualChildren.length;c<d;c+=1)b=Math.max(b,this._getItemDepth(a.visualChildren[c]));return b+1};
primitives.orgdiagram.Controller.prototype._layoutChildren=function(a,b,c){var d,e,f,g,h,j,m,k,l,i;f=a.itemConfig.childrenPlacementType;switch(this.options.horizontalAlignment){case 0:case 1:e=3;break;case 2:e=2}0===f&&(f=this._hasLeavesOnly(a)?0===this.options.leavesPlacementType?3:this.options.leavesPlacementType:0===this.options.childrenPlacementType?2:this.options.childrenPlacementType);if(2!==f)switch(d=a,null!==a.visualAggregatorId&&(d=this._treeItems[a.visualAggregatorId]),f){case 3:if(3<d.visualChildren.length){a=
d.visualChildren.slice(0);d.visualChildren.length=0;j=Math.min(this.options.maximumColumnsInMatrix,Math.ceil(Math.sqrt(a.length)));m=Math.ceil(a.length/j);k=Math.ceil(j/2);for(l=0;l<k;l+=1){e=d;for(i=0;i<m;i+=1){f=this._getMatrixItem(a,2*l,i,j,m);g=this._getMatrixItem(a,2*l+1,i,j,m);void 0===b[i]&&(b[i]=[],c[i]=[]);null!==f&&(e.visualChildren.push(f),f.visualParentId=e.id,f.connectorPlacement=3,c[i].push(f));if(null!==f||null!==g)h=this._getNewTreeItem({visibility:4,visualParentId:e.id}),e.visualChildren.push(h),
e.visualAggregatorId=h.id,b[i].push(h);null!==g&&(e.visualChildren.push(g),g.visualParentId=e.id,g.connectorPlacement=7,c[i].push(g));e=h}}2<j&&(d.visualAggregatorId=null)}break;case 1:a=d.visualChildren.slice(0);g=d.visualChildren.length=0;for(j=a.length;g<j;g+=1){f=a[g];h=this._getNewTreeItem({visibility:4,visualParentId:d.id});d.visualAggregatorId=h.id;f.visualParentId=d.id;switch(e){case 2:d.visualChildren.push(f);d.visualChildren.push(h);f.connectorPlacement=3;break;case 3:d.visualChildren.push(h),
d.visualChildren.push(f),f.connectorPlacement=7}b[g]=[h];c[g]=[f];d=h}}};primitives.orgdiagram.Controller.prototype._getMatrixItem=function(a,b,c,d){0<d%2&&(b===d-1?b=a.length:b===d&&(b=d-1));b=c*d+b;return b>a.length-1?null:a[b]};primitives.orgdiagram.Controller.prototype._hasLeavesOnly=function(a){var b=!1,c,d,e;if(null!==a.itemConfig&&(e=a.itemConfig.items,c=e.length,0<c)){b=!0;for(a=0;a<c;a+=1)if(d=e[a],(0===d.itemType||3===d.itemType)&&0<d.items.length){b=!1;break}}return b};
primitives.orgdiagram.Controller.prototype._findLeftSiblingIndex=function(a,b){var c=null,d,e;for(e=a.length-1;0<=e;e-=1)if(d=a[e],null===c)d===b&&(c=-1);else if(0===d.actualItemType||3===d.actualItemType){c=e;break}return c};primitives.orgdiagram.Controller.prototype._findRightSiblingIndex=function(a,b){var c=null,d,e,f;e=0;for(f=a.length;e<f;e+=1)if(d=a[e],null===c)d===b&&(c=f);else if(0===d.actualItemType||3===d.actualItemType){c=e;break}return c};
primitives.orgdiagram.Controller.prototype._createNewVisualRoot=function(a){var b=this._getNewTreeItem({visibility:4,visualParentId:null});b.visualChildren.push(a);this._visualRootItem=a.visualParentId=b.id};
primitives.orgdiagram.Controller.prototype._createNewVisualAggregator=function(a){var b,c;b=this._getNewTreeItem({visibility:4,visualParentId:a.id,visualAggregatorId:a.visualAggregatorId});b.visualChildren=a.visualChildren;for(c=0;c<b.visualChildren.length;c+=1)b.visualChildren[c].visualParentId=b.id;a.visualChildren=[b];a.visualAggregatorId=b.id;return b};
primitives.orgdiagram.Controller.prototype._readVisualTree=function(a,b){var c=this._treeLevels[b],d,e;void 0===c&&(c=this._treeLevels[b]=new primitives.orgdiagram.TreeLevel(b));c.treeItems.push(a.id);a.level=b;a.levelPosition=c.treeItems.length-1;c=a.itemConfig;null!==c&&(d=this._templates[c.templateName],a.template=void 0!==d?d:this._defaultTemplate,c===this.options.cursorItem&&(this._cursorTreeItem=a,this._cursorTreeItem.isCursor=!0),c===this.options.highlightItem&&(this._highlightTreeItem=a),
0<=primitives.common.indexOf(this.options.selectedItems,c)&&this._selectedTreeItems.push(a),a.hasSelectorCheckbox=this._getSelectionVisibility(a.isCursor,c.hasSelectorCheckbox,this.options.hasSelectorCheckbox),a.hasButtons=0<this.options.buttons.length&&this._getSelectionVisibility(a.isCursor,c.hasButtons,this.options.hasButtons));c=0;for(d=a.visualChildren.length;c<d;c+=1)e=a.visualChildren[c],0===c&&this._updateLeftMargins(e,0),c===d-1&&this._updateRightMargins(e,0),this._readVisualTree(e,b+1)};
primitives.orgdiagram.Controller.prototype._updateLeftMargins=function(a,b){for(var c=a,d;null!==(c=this._getParentItem(c));)d=this._leftMargins[c.id],void 0===d&&(d=this._leftMargins[c.id]=[]),void 0===d[b]&&(d[b]=a.id),b+=1};primitives.orgdiagram.Controller.prototype._updateRightMargins=function(a,b){for(var c=a,d;null!==(c=this._getParentItem(c));)d=this._rightMargins[c.id],void 0===d&&(d=this._rightMargins[c.id]=[]),d[b]=a.id,b+=1};
primitives.orgdiagram.Controller.prototype._showSelectedItems=function(){var a,b;for(a=0;a<this._selectedTreeItems.length;a+=1)switch(b=this._selectedTreeItems[a],b.isSelected=!0,0===b.visibility&&(b.visibility=1),this.options.selectionPathMode){case 1:for(;void 0!==b;)0===b.visibility&&(b.visibility=1),b=this._treeItems[b.logicalParentId]}};
primitives.orgdiagram.Controller.prototype._showCursorNeigbours=function(){var a,b;if(null!==this._cursorTreeItem){for(a=0;a<this._cursorTreeItem.logicalChildren.length;a+=1)b=this._cursorTreeItem.logicalChildren[a],0===b.visibility&&(b.visibility=1);for(b=this._cursorTreeItem;void 0!==b;)0===b.visibility&&(b.visibility=1),b=this._treeItems[b.logicalParentId]}};
primitives.orgdiagram.Controller.prototype._getSelectionVisibility=function(a,b,c){var d=!1;switch(b){case 0:switch(c){case 0:d=a;break;case 1:d=!0;break;case 2:d=!1}break;case 1:d=!0;break;case 2:d=!1}return d};primitives.orgdiagram.LevelVisibility=function(a,b){this.level=a;this.currentvisibility=b};
primitives.orgdiagram.Template=function(a){this.widgetEventPrefix="orgdiagram";this.templateConfig=a;this.name=a.name;this.itemSize=a.itemSize;this.itemBorderWidth=a.itemBorderWidth;this.minimizedItemSize=a.minimizedItemSize;this.highlightPadding=a.highlightPadding;this.highlightBorderWidth=a.highlightBorderWidth;this.cursorPadding=a.cursorPadding;this.cursorBorderWidth=a.cursorBorderWidth;this.itemTemplate=a.itemTemplate;this.highlightTemplate=a.highlightTemplate;this.cursorTemplate=a.cursorTemplate;
this.itemTemplateHashCode=null;this.itemTemplateRenderName="onItemRender";this.highlightTemplateHashCode=null;this.highlightTemplateRenderName="onHighlightRender";this.cursorTemplateHashCode=null;this.cursorTemplateRenderName="onCursorRender";this.boxModel=jQuery.support.boxModel};
primitives.orgdiagram.Template.prototype.createDefaultTemplates=function(a){primitives.common.isNullOrEmpty(this.itemTemplate)&&(this.itemTemplate=this._getDefaultItemTemplate(a),this.itemTemplateRenderName="onDefaultTemplateRender");this.itemTemplateHashCode=primitives.common.hashCode(this.itemTemplate);primitives.common.isNullOrEmpty(this.cursorTemplate)&&(this.cursorTemplate=this._getDefaultCursorTemplate(a),this.cursorTemplateRenderName=null);this.cursorTemplateHashCode=primitives.common.hashCode(this.cursorTemplate);
primitives.common.isNullOrEmpty(this.highlightTemplate)&&(this.highlightTemplate=this._getDefaultHighlightTemplate(),this.highlightTemplateRenderName=null);this.highlightTemplateHashCode=primitives.common.hashCode(this.highlightTemplate)};
primitives.orgdiagram.Template.prototype._getDefaultItemTemplate=function(){var a=new primitives.common.Size(this.itemSize),b,c,d;a.width-=this.boxModel?2*this.itemBorderWidth:0;a.height-=this.boxModel?2*this.itemBorderWidth:0;b=jQuery("<div></div>").css({"border-width":this.itemBorderWidth+"px"}).addClass("bp-item bp-corner-all bt-item-frame");c=jQuery('<div name="titleBackground"></div>').css({top:"2px",left:"2px",width:a.width-4+"px",height:"18px"}).addClass("bp-item bp-corner-all bp-title-frame");
b.append(c);d=jQuery('<div name="title"></div>').css({top:"1px",left:"4px",width:a.width-4-8+"px",height:"16px"}).addClass("bp-item bp-title");c.append(d);c=jQuery("<div></div>").css({top:"24px",left:"2px",width:"50px",height:"60px"}).addClass("bp-item bp-photo-frame");b.append(c);d=jQuery('<img name="photo" alt=""></img>').css({width:"50px",height:"60px"});c.append(d);a=jQuery('<div name="description"></div>').css({top:"24px",left:"56px",width:a.width-4-56+"px",height:"74px"}).addClass("bp-item bp-description");
b.append(a);return b.wrap("<div>").parent().html()};primitives.orgdiagram.Template.prototype._getDefaultCursorTemplate=function(){return jQuery("<div></div>").css({width:this.itemSize.width+this.cursorPadding.left+this.cursorPadding.right+"px",height:this.itemSize.height+this.cursorPadding.top+this.cursorPadding.bottom+"px","border-width":this.cursorBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame").wrap("<div>").parent().html()};
primitives.orgdiagram.Template.prototype._getDefaultHighlightTemplate=function(){return jQuery("<div></div>").css({"border-width":this.highlightBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-highlight-frame").wrap("<div>").parent().html()};
primitives.orgdiagram.TreeItem=function(a){this.id=a;this.visualParentId=this.logicalParentId=this.itemConfig=null;this.visualChildren=[];this.logicalChildren=[];this.visualAggregatorId=null;this.visibility=1;this.levelPosition=this.level=this.template=null;this.padding=this.offset=0;this.actualVisibility=1;this.contentPosition=this.actualPosition=this.actualSize=null;this.hasGroupTitle=this.hasButtons=this.hasSelectorCheckbox=this.isSelected=this.isCursor=!1;this.actualItemType=null;this.connectorPlacement=
1};
primitives.orgdiagram.TreeItem.prototype.setActualSize=function(a,b){var c=primitives.common;this.actualVisibility=0===this.visibility?a.currentvisibility:this.visibility;switch(this.actualVisibility){case 1:this.actualSize=new c.Size(this.template.itemSize);this.contentPosition=new c.Rect(0,0,this.actualSize.width,this.actualSize.height);this.isCursor&&(this.actualSize.height+=this.template.cursorPadding.top+this.template.cursorPadding.bottom,this.actualSize.width+=this.template.cursorPadding.left+this.template.cursorPadding.right,
this.contentPosition.x=this.template.cursorPadding.left,this.contentPosition.y=this.template.cursorPadding.top);this.hasSelectorCheckbox&&(this.actualSize.height+=b.checkBoxPanelSize);this.hasButtons&&(this.actualSize.width+=b.buttonsPanelSize);if(this.hasGroupTitle=!c.isNullOrEmpty(this.itemConfig.groupTitle))this.actualSize.width+=b.groupTitlePanelSize,this.contentPosition.x+=b.groupTitlePanelSize;break;case 2:this.actualSize=new c.Size(this.template.minimizedItemSize);break;case 3:case 4:this.actualSize=
new c.Size}switch(b.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:this.actualSize.invert()}};primitives.orgdiagram.TreeItem.prototype.setActualPosition=function(a,b){var c=0;switch(b.verticalAlignment){case 0:c=0;break;case 1:c=(a.depth-this.actualSize.height)/2;break;case 2:c=a.depth-this.actualSize.height}this.actualPosition=new primitives.common.Rect(this.offset,a.shift+c,this.actualSize.width,this.actualSize.height);switch(b.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:this.actualSize.invert()}};
primitives.orgdiagram.TreeItem.prototype.toString=function(){return this.id};primitives.orgdiagram.TreeLevel=function(a){this.level=a;this.actualVisibility=this.currentvisibility=1;this.connectorShift=this.topConnectorShift=this.currentOffset=this.depth=this.shift=0;this.treeItems=[]};primitives.orgdiagram.TreeLevel.prototype.toString=function(){return this.level+"."+this.currentvisibility};(function(a){a.widget("ui.orgDiagram",new primitives.orgdiagram.Controller)})(jQuery);
